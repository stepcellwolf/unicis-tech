<!doctype html>
<html lang="">	
<head>
	<meta charset="utf-8"/>
	<title>Ministry of Interior – Macedonia, website defacement: http://mvr.gov.mk - Predrag TASEVSKI - Pece</title>	
	<meta name="author" content="Predrag TASEVSKI - Pece">
	

	<meta name="description" content="Purpose Yesterday, the 25 of June 2012, the Macedonian website of Ministry of Interior (MVR) was defaced by Kosovo Network Security (KNS) group, below figure. However, after we have noticed and some of the social networking sites have informed me, I was concern to find out what just have happened ...">


	<link rel="top" href="#" /><link href='http://fonts.googleapis.com/css?family=Source+Sans+Pro:300,400,600,300italic,400italic,600italic|Source+Code+Pro' rel='stylesheet' type='text/css'></link>
	<link rel="stylesheet" href="../../../../theme/css/main.css" type="text/css" />
		

</head>
	
<body>

    <div class="container">
	  
	  <header role="banner">
	    <div class="feeds">
	    </div>
	      <nav class="pages">
			  <a href="../../../../pages/about-cv.html">About (CV)</a>
-			  <a href="../../../../pages/publications.html">Publications</a>
	      </nav>
		<a href="../../../.." class="title">Predrag TASEVSKI - Pece</a>
      </header>
	
	  <div class="wrapper">

		  <div role="main" class="content">
	<article class="full">
			
		<h1>Ministry of Interior – Macedonia, website defacement: http://mvr.gov.mk</h1>
		
<div class="metadata">
  <time datetime="2012-06-26T00:00:00" pubdate>mar. 26 juin 2012</time>
    <address class="vcard author">
      by <a class="url fn" href="../../../../author/predrag-tasevski-pece.html">Predrag TASEVSKI - Pece</a>
    </address>
  in <a href="../../../../category/cyber-security.html">cyber security</a>
<p class="tags">tagged <a href="../../../../tag/attacks.html">Attacks</a>, <a href="../../../../tag/cyber-security.html">cyber security</a>, <a href="../../../../tag/information-warfare.html">information warfare</a>, <a href="../../../../tag/legal-aspects-of-cyber-security.html">legal aspects of cyber security</a>, <a href="../../../../tag/log-mining.html">log mining</a>, <a href="../../../../tag/ddos.html">DDoS</a>, <a href="../../../../tag/exploitation.html">exploitation</a>, <a href="../../../../tag/kns.html">kns</a>, <a href="../../../../tag/macedonia.html">macedonia</a>, <a href="../../../../tag/mvr.html">mvr</a>, <a href="../../../../tag/online.html">online</a>, <a href="../../../../tag/security.html">security</a>, <a href="../../../../tag/vulnerability.html">vulnerability</a>, <a href="../../../../tag/expolit.html">expolit</a></p></div>		
		<h1>Purpose</h1>
<p>Yesterday, the 25 of June 2012, the Macedonian website of Ministry of Interior (MVR) was defaced by Kosovo Network Security (KNS) group, below figure. However, after we have noticed and some of the social networking sites have informed me, I was concern to find out what just have happened and how did happen, and of course how they have done it. So for this purpose, I have done some digging into details, about the previous defacement activities of this very important government site. But before we continue with more details, let just talk about the situation of yesterday and what did the authorities take protective measures steps and actions.</p>
<p>On Monday, 25 June 2012 at 19:38, one friend have updated his status in one of the social networking sites, as follows: “Хакован <a href="http://mvr.gov.mk/" target="_blank">http://mvr.gov.mk/</a>” (Hacked <a href="http://mvr.gov.mk/" target="_blank">http://mvr.gov.mk/</a>). And it made me extremely intrigue to see what actually have just happened. The below figure, displays the message spread from the KNS group.</p>
<p><img class=" wp-image-430" title="MVR site, Defaced by KNS group" src="http://predragtasevski.com/img/hak_mrv.png"  width="1302" height="714">
Screenshot from the mvr.gov.mk defaced version</p>
<p>Moreover, what makes the situation even more interesting is that after the report that the site was defaced the authorities have taken a measures steps to fix the issue, by either shutting down the server or restoring the content of the site from the backup. Then after one or two minutes the site was defaced again. I did not want to lose the time and the nervous to check every five or ten minutes to see when it will be back again.</p>
<p>Nevertheless, after 15 hours, or one stressful – hard core night for the administrators of the site, the usability and functionalities where back as normal, let just see how long will stay!</p>
<p>Therefore, in the current post the idea is to give and overview, of what actually is going on when it comes to case of cyber space, cyber security issues in Macedonia. The structure of this post is introduces first with the issue, or the problem that actuality made me to write this post. Followed by the background investigation about the previous defacement activities on the Ministry of Interior website in Macedonia. Then with the background investigation about the KNS group, moreover, with the self pen-testing site with different attacking methodologies. And finally, closing by with a conclusion and action plan that should be taken, for hence actions. This post does not only involves the public sector, but even and the private sector too. Those agencies, organizations are too much careless and do not take any actions of securing their IT assets.</p>
<h1>Introduction</h1>
<p>Ministry of Interior in Macedonia site offers different online services. The site primary idea is to inform the inhabitance about the news, actions, useful information, public relations, analysis and statistics; international cooperation and legislation; and finally the services. And secondly is to give and opportunities to the population scheduling of service, if their document is issued, etc.</p>
<p>In one short sentence, this site, for some people, it may be very useful or not. However, I need to&nbsp;empathize that the site is only available in Macedonian language, nor Albania, nor English version. So, in simple conclusion this site is only useful for Macedonian speakers, and not for foreigners, yet still represents one of very important public service, government agency.</p>
<p>Nevertheless, in the next section we will discuses the previous defacement and hacking attacks of this site.</p>
<h1>Background</h1>
<p>The service of this site, or the domain first was registered in 22 October 2003, and unfortunate I do not remember when was first time available and published. However, in the pass years I have heard many times that this site was defaced and hacked, but still no actions or results were shown. Therefore, it made me very interesting to find out, if this defacement activities where notified and when and how many where. For this purpose I have use a site service that I know few years ago, the <a href="http://www.zone-h.org/" target="_blank">Zone-H</a>. Moreover, <a href="http://www.zone-h.org/" target="_blank">Zone-H</a> is neither responsible for the reported computer crimes nor it is directly or indirectly involved with them, it is just and simple site where collects the cybercrime activities notified anonymously. The bellow figure provides a details of previous reported/notified cybercrime activities of MVR site in Macedonia.</p>
<p><img class="size-full wp-image-431" title="Zone-H.org archive" src="http://predragtasevski.com/img/mvr_gov_reported.png"  width="902" height="570">
<p>In details, total notifications are 4 of which 2 are single IP and 2 are mass defacements. The first mass defacement was done in 29 July 2009, when the site use a OS: Windows 2000, then in 2011 it was the re-defacement and the server operating system is Windows 2008. Followed by the other massive defacement in this year 2012 in March 18, and same year, few days before the current attack, 22 of June it was re-defacement. And the attack, defacement that we write for it was not notified or reported.</p>
<p>From these data, and schedule, we can come to a conclusion that the site was defaced just 3 days before the mass defacement attack, so it might be a simple warning, to taken an action before something goes really wrong. But most probably, non of those administrators, or authorities did not taken any serious actions, until the case yesterday appears.</p>
<h1>Details</h1>
<p>To be able to do an analysis of what actually have happened, we need to take some actions.</p>
<p>First, we have done a simple web sniffer, to find out what kind of system, and services the site, server is using. If we request the <a href="http://en.wikipedia.org/wiki/List_of_HTTP_header_fields" target="_blank">HTTP Request Header</a> we will receive an HTTP Response Header with a following data:</p>
<div class="highlight"><pre><span class="n">Status</span><span class="o">:</span> <span class="n">HTTP</span><span class="o">/</span><span class="mf">1.1</span> <span class="mi">200</span> <span class="n">OK</span>
<span class="n">Cache</span><span class="o">-</span><span class="n">Control</span><span class="o">:</span> <span class="kd">private</span>
<span class="n">Content</span><span class="o">-</span><span class="n">Type</span><span class="o">:</span> <span class="n">text</span><span class="o">/</span><span class="n">html</span><span class="o">;</span> <span class="n">charset</span><span class="o">=</span><span class="n">utf</span><span class="o">-</span><span class="mi">8</span>
<span class="n">Server</span><span class="o">:</span> <span class="n">Microsoft</span><span class="o">-</span><span class="n">IIS</span><span class="o">/</span><span class="mf">7.0</span>
<span class="n">Set</span><span class="o">-</span><span class="n">Cookie</span><span class="o">:</span> <span class="n">ASP</span><span class="o">.</span><span class="na">NET_SessionId</span><span class="o">=</span><span class="mi">3</span><span class="n">lti3gep3usg4255ggf34tjn</span><span class="o">;</span> <span class="n">path</span><span class="o">=/;</span> <span class="n">HttpOnly</span>
<span class="n">X</span><span class="o">-</span><span class="n">AspNet</span><span class="o">-</span><span class="n">Version</span><span class="o">:</span> <span class="mf">2.0</span><span class="o">.</span><span class="mi">50727</span>
<span class="n">X</span><span class="o">-</span><span class="n">Powered</span><span class="o">-</span><span class="n">By</span><span class="o">:</span> <span class="n">ASP</span><span class="o">.</span><span class="na">NET</span>
<span class="n">Date</span><span class="o">:</span> <span class="n">Tue</span><span class="o">,</span> <span class="mi">26</span> <span class="n">Jun</span> <span class="mi">2012</span> <span class="mi">08</span><span class="o">:</span><span class="mi">18</span><span class="o">:</span><span class="mi">34</span> <span class="n">GMT</span>
<span class="n">Connection</span><span class="o">:</span> <span class="n">close</span>
<span class="n">Content</span><span class="o">-</span><span class="n">Length</span><span class="o">:</span> <span class="mi">103773</span>
</pre></div>


<p>The above data, is useful in a sense that provides as an information about the Server and the ASP.Net Version. Then, if we want to find more details about the open and close ports and operating system we can use the <a href="http://nmap.org/" target="_blank">nmap</a> tool with the following command line:</p>
<p><code>nmap -O -v IP-Address</code></p>
<p>And the results will be as follows:</p>
<div class="highlight"><pre><span class="n">PORT</span> <span class="n">STATE</span> <span class="n">SERVICE</span>
<span class="mi">21</span><span class="o">/</span><span class="n">tcp</span> <span class="n">open</span> <span class="n">ftp</span>
<span class="mi">80</span><span class="o">/</span><span class="n">tcp</span> <span class="n">open</span> <span class="n">http</span>
<span class="n">Running</span> <span class="p">(</span><span class="n">JUST</span> <span class="n">GUESSING</span><span class="p">)</span> <span class="o">:</span> <span class="n">Microsoft</span> <span class="n">Windows</span> <span class="n">Vista</span><span class="o">|</span><span class="mi">2008</span><span class="o">|</span><span class="mi">7</span> <span class="p">(</span><span class="mi">89</span><span class="o">%</span><span class="p">)</span>
</pre></div>


<p>From the web sniffing and from the OS version scanning we can assume that the server is running Microsoft Windows 2008. The current vulnerabilities and possible exploitations are visible on the <a href="http://technet.microsoft.com/en-us/security/bulletin/" target="_blank">Microsoft Security Bulletins</a> website. By knowing the vulnerabilities it is very easy task to find out a way either to commit DoS attack or remote server access. However, in this post we will not go into details and exploitation descriptions.</p>
<p>Moreover, the KNS, we assume the domain is followed: <a href="http://kns-team.com/" target="_blank">http://kns-team.com</a>. However, the site is down, therefore, we will have to understand who is behind this domain registration. Therefore, we will use the whois database to understand more, or even we can use another site that have been defaced by this group to find out more. So there is the list presented the members in the groups and their archive of notified defaced sites:</p>
<ul>
<li><a href="http://www.zone-h.org/archive/notifier=cracker-besi" target="_blank">rAcKeR-BeSi</a></li>
<li>GP</li>
<li><a href="http://www.zone-h.org/archive/notifier=L0wHacker" target="_blank">L0wHacker</a></li>
<li>sLizer</li>
<li>X-r00t</li>
<li>SpyHackz</li>
</ul>
<p>The Facebook fan page is: <a href="https://www.facebook.com/pages/Kosova-Network-Security/176195849098989" target="_blank">https://www.facebook.com/pages/Kosova-Network-Security/176195849098989</a>. For more info I was short of time to do more digging, but I hope that someone will.</p>
<h1>Action</h1>
<p>After understanding the details about the MVR site, operating system and their server services, and information about the KNS, it is time to take an action of trying to see how vulnerable is MVR site, and to see if these lads had very difficult time of defacing the content of the site, or even gaining access to the server-side.</p>
<p>But before, we carry on, I want to stress out that this section is not to give you an idea how, or knowledge to exploit or use any vulnerabilities to deface or gain access to the site. We will just demonstrate you a very simple <a href="http://en.wikipedia.org/wiki/Cross-site_scripting" target="_blank">XSS</a> exploit of MVR site that we have found a vulnerability, figure below.</p>
<p><img class="size-full wp-image-432" title="XSS vulnerabiltiy example" src="http://predragtasevski.com/img/mvr_XSS.png"  width="1320" height="718">
Example of exploitation by XSS vulnerability, mvr.gov.mk</p>
<p>It is therefore, from this very simple and easy exploitation of XSS vulnerability of the MVS site we will be able to run more advance and complicated shell scripts to gain access and maintain access of the server. Our initial idea is not to show you how to do it, but to expose to the audience that actually hence actions is need it. And we hope that the administrators, developers and the authorities will take an action of mitigating the risk, and further vulnerabilities of the site.</p>
<h1>Conclusion</h1>
<p>In Macedonia, cyber space, cyber crime, cyber security, cyber warefare, cyber terrorism are actually unknown words, terminology. They are not even specified or added into the Macedonian dictionary, nor in IT dictionary. However, this is not the first or least defacement, attack that has happened in Macedonia, nor the first attack that has been done, implemented by neighbor countries, or someone else. I just don’t understand why people in this country are so careless about how to protect their IT assets, and everything else, as well.</p>
<p>Furthermore, it is not an issue that we do not have&nbsp;specialists to conduct a pen-testing to the sites and services that not only the government agencies are offering but even the banks and private sectors as well. We even have a cyber crime unit in Ministry of Interior, and one of very successful information security research and development laboratory in Macedonia: <a href="http://www.zeroscience.mk/en/" target="_blank">Zero Science Lab</a>. Also, the <a href="http://cybersecurity.mk/icsap/" target="_blank">ICSAP – Interactive Cyber Security Awareness Program</a>, Macedonia project, developed by myself.</p>
<p>Nevertheless, in final conclusion, I would like to recommend the authorities to take actions about the above described activities done by KNS and hope that the security awareness will boost up, and the further actions will be considered of securing cyber space.</p>	

	</article>

    <p>
	<a href="https://twitter.com/share" class="twitter-share-button" data-via="" data-lang="en" data-size="large" data-related="">Tweet</a>
	<script>!function(d,s,id){var js,fjs=d.getElementsByTagName(s)[0];if(!d.getElementById(id)){js=d.createElement(s);js.id=id;js.src="//platform.twitter.com/widgets.js";fjs.parentNode.insertBefore(js,fjs);}}(document,"script","twitter-wjs");</script>
	</p>


		  </div>	
		  
		  <div class="sidebar">

	        <nav>
	          <h2>Categories</h2>
	          <ul>
	              <li ><a href="../../../../category/awareness.html">awareness</a></li>
	              <li ><a href="../../../../category/camp.html">camp</a></li>
	              <li ><a href="../../../../category/collectivistic.html">collectivistic</a></li>
	              <li ><a href="../../../../category/company.html">company</a></li>
	              <li ><a href="../../../../category/conference.html">conference</a></li>
	              <li ><a href="../../../../category/cyber-crime.html">cyber crime</a></li>
	              <li class="active"><a href="../../../../category/cyber-security.html">cyber security</a></li>
	              <li ><a href="../../../../category/cyberwar.html">cyberwar</a></li>
	              <li ><a href="../../../../category/cyberwarfare.html">cyberwarfare</a></li>
	              <li ><a href="../../../../category/digital-divide.html">digital divide</a></li>
	              <li ><a href="../../../../category/hate-speech.html">hate speech</a></li>
	              <li ><a href="../../../../category/hate-speechnetwork-security.html">hate speechnetwork security</a></li>
	              <li ><a href="../../../../category/honeypot.html">honeypot</a></li>
	              <li ><a href="../../../../category/human-communication.html">human communication</a></li>
	              <li ><a href="../../../../category/human-computer-interaction.html">human computer interaction</a></li>
	              <li ><a href="../../../../category/human-rights.html">human rights</a></li>
	              <li ><a href="../../../../category/ids.html">IDS</a></li>
	              <li ><a href="../../../../category/interview.html">interview</a></li>
	              <li ><a href="../../../../category/leaks.html">leaks</a></li>
	              <li ><a href="../../../../category/malware.html">malware</a></li>
	              <li ><a href="../../../../category/network-security.html">network security</a></li>
	              <li ><a href="../../../../category/password-attacks.html">password attacks</a></li>
	              <li ><a href="../../../../category/regular-expression.html">regular expression</a></li>
	              <li ><a href="../../../../category/research.html">research</a></li>
	              <li ><a href="../../../../category/risk-assessment.html">risk assessment</a></li>
	              <li ><a href="../../../../category/script-kiddie.html">script kiddie</a></li>
	              <li ><a href="../../../../category/security-programing.html">security programing</a></li>
	              <li ><a href="../../../../category/security-testing.html">security testing</a></li>
	              <li ><a href="../../../../category/social-networks.html">social networks</a></li>
	              <li ><a href="../../../../category/texworks.html">texworks</a></li>
	              <li ><a href="../../../../category/thinkpad.html">thinkpad</a></li>
	              <li ><a href="../../../../category/virtual-life.html">virtual life</a></li>
	              <li ><a href="../../../../category/wireless-security.html">wireless security</a></li>
	              <li ><a href="../../../../category/wordpress.html">wordpress</a></li>
	          </ul>
	        </nav>

	          <aside>
	          <h2>Social</h2>
			    <ul class="social">
				  <li><a href="https://www.linkedin.com/in/tpredrag">Linkedin</a><i></i></li>
				  <li><a href="https://twitter.com/stepcellwolf">Twitter</a><i></i></li>
				  <li><a href="https://github.com/stepcellwolf/">Github</a><i></i></li>
			    </ul>
			  </aside>

	          <aside>
	            <h2>Blogroll</h2>
	            <ul>
	                <li><a href="http://getpelican.com/">Pelican</a></li>
	                <li><a href="http://python.org/">Python.org</a></li>
	                <li><a href="http://jinja.pocoo.org/">Jinja2</a></li>
	                <li><a href="#">You can modify those links in your config file</a></li>
	            </ul>
	          </aside>

		  </div>

	  </div>

      <footer>
		<p role="contentinfo">
		  © 2013 Predrag TASEVSKI - Pece - Proudly powered by <a href="http://alexis.notmyidea.org/pelican/">pelican</a>. Theme <a href="https://github.com/fle/pelican-simplegrey">pelican-simplegrey</a>.
    	</p>

	  </footer>	

	</div>
	

</body>
</html>