<!doctype html>
<html lang="">	
<head>
	<meta charset="utf-8"/>
	<title>Mobile Malware Analysis - Predrag TASEVSKI - Pece</title>	
	<meta name="author" content="Predrag TASEVSKI - Pece">
	

	<meta name="description" content="PURPOSE The goal of this post is to identify and analyze mobile malware file: mmc.jar. Thereby please follow the following steps for completing the task: Unpack the file (hint – using zip on .jar) Examine .class files using tool available here (local copies for Mac and Linux and Win Find ...">


	<link rel="top" href="#" /><link href='http://fonts.googleapis.com/css?family=Source+Sans+Pro:300,400,600,300italic,400italic,600italic|Source+Code+Pro' rel='stylesheet' type='text/css'></link>
	<link rel="stylesheet" href="../../../../theme/css/main.css" type="text/css" />
		

</head>
	
<body>

    <div class="container">
	  
	  <header role="banner">
	    <div class="feeds">
	    </div>
	      <nav class="pages">
			  <a href="../../../../pages/about-cv.html">About (CV)</a>
-			  <a href="../../../../pages/publications.html">Publications</a>
	      </nav>
		<a href="../../../.." class="title">Predrag TASEVSKI - Pece</a>
      </header>
	
	  <div class="wrapper">

		  <div role="main" class="content">
	<article class="full">
			
		<h1>Mobile Malware Analysis</h1>
		
<div class="metadata">
  <time datetime="2012-01-17T00:00:00" pubdate>mar. 17 janvier 2012</time>
    <address class="vcard author">
      by <a class="url fn" href="../../../../author/predrag-tasevski-pece.html">Predrag TASEVSKI - Pece</a>
    </address>
  in <a href="../../../../category/malware.html">malware</a>
<p class="tags">tagged <a href="../../../../tag/cell-phone.html">cell phone</a>, <a href="../../../../tag/malware.html">malware</a>, <a href="../../../../tag/mobile.html">mobile</a>, <a href="../../../../tag/mobile-malware-analysis.html">mobile malware analysis</a>, <a href="../../../../tag/network-crime.html">network crime</a>, <a href="../../../../tag/phone.html">phone</a>, <a href="../../../../tag/phone-games.html">phone games</a>, <a href="../../../../tag/phone-malware.html">phone malware</a>, <a href="../../../../tag/security.html">security</a>, <a href="../../../../tag/sms.html">sms</a>, <a href="../../../../tag/binary.html">binary</a></p></div>		
		<h1>PURPOSE</h1>
<p>The goal of this post is to identify and analyze mobile malware file: <a href="https://sim.cert.ee/hw/mmc.jar" target="_blank">mmc.jar</a>. Thereby please follow the following steps for completing the task:</p>
<ul>
<li>Unpack the file (hint – using zip on .jar)</span></li></li>
<li>Examine .class files using tool available <a href="http://java.decompiler.free.fr/?q=jdgui" target="_blank">here</a> (local copies for <a href="https://sim.cert.ee/hw/jd-gui-0.3.3.osx.i686.dmg" target="_blank">Mac</a> and <a href="https://sim.cert.ee/hw/jd-gui-0.3.3.linux.i686.tar.gz"> Linux</a> and <a href="https://sim.cert.ee/hw/jd-gui-0.3.3.windows.zip" target="_blank">Win</a></li>
<li>Find code sending SMSes using ‘sms://’ URI </li>
<li>Calculate short number used in SM.send</li>
<li>Finally for compiling the code use the developing tool <a href="http://www.eclipse.org/" target="_blank">Eclipse IDE</a>.</li>
</ul>
<p>Firstly, we are going to analysis the Java source code after decompilation. The accent is to find the code that is sending an SMSes using the ‘sms://’ URL. After identifying the linking associated classes we have to compile the code to move toward to final results of URLs. For this purpose we are using the developing tool <a href="http://www.eclipse.org/downloads/" target="_blank">Eclipse IDE</a>.</p>
<p>Therefore, the results and the sent SMSes URLs are going to be presented into conclusion section. Which will complete the task and will yield the basic analysis of mobile malware file.</p>
<h1>ANALYSIS</h1>
<p>After running the decompiler tool we are examining and&nbsp;analyzing&nbsp;the Java source code. Whereby on the source code on the class M.class line 343 we have found the following source code:</p>
<div class="highlight"><pre><span class="k">if</span> <span class="p">((</span><span class="n">i</span> <span class="o">&amp;</span><span class="n">gt</span><span class="p">;</span><span class="o">=</span> <span class="mi">35</span><span class="p">)</span>  <span class="p">(</span><span class="n">SM</span><span class="p">.</span><span class="n">isSending</span> <span class="o">!=</span> <span class="nb">true</span><span class="p">)</span>  <span class="p">(</span><span class="n">i</span> <span class="o">%</span> <span class="mi">6</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="p">(</span><span class="n">f</span> <span class="o">&amp;</span> <span class="n">count_query</span><span class="p">))</span> <span class="p">{</span>
  <span class="k">if</span> <span class="p">(</span><span class="n">SM</span><span class="p">.</span><span class="n">GS</span><span class="p">())</span> <span class="n">f</span> <span class="o">+=</span> <span class="mi">1</span><span class="p">;</span>
   <span class="k">if</span> <span class="p">(</span><span class="n">f</span> <span class="o">==</span> <span class="mi">1</span><span class="p">)</span> <span class="p">{</span>
            <span class="n">RS</span><span class="p">.</span><span class="n">L</span><span class="p">(</span><span class="n">rs</span><span class="p">);</span>
            <span class="n">RS</span><span class="p">.</span><span class="n">L</span><span class="p">(</span><span class="s">&quot;Slide&quot;</span><span class="p">);</span>
            <span class="n">rs</span> <span class="o">=</span> <span class="n">RS</span><span class="p">.</span><span class="n">j</span><span class="p">(</span><span class="s">&quot;Slide&quot;</span><span class="p">);</span>
            <span class="n">game</span> <span class="o">=</span> <span class="n">RS</span><span class="p">.</span><span class="n">L</span><span class="p">(</span><span class="n">rs</span><span class="p">,</span> <span class="n">Integer</span><span class="p">.</span><span class="n">toString</span><span class="p">((</span><span class="kt">int</span><span class="p">)(</span><span class="n">System</span><span class="p">.</span><span class="n">currentTimeMillis</span><span class="p">()</span> <span class="o">/</span> <span class="mi">1000L</span><span class="p">)));</span>
            <span class="n">RS</span><span class="p">.</span><span class="n">L</span><span class="p">(</span><span class="n">rs</span><span class="p">);</span>
   <span class="p">}</span><span class="k">if</span> <span class="p">(</span><span class="n">f</span> <span class="o">&amp;</span><span class="n">lt</span><span class="p">;</span> <span class="n">count_query</span><span class="p">)</span> <span class="p">{</span>
  <span class="n">game</span> <span class="o">=</span> <span class="n">SM</span><span class="p">.</span><span class="n">send</span><span class="p">(</span><span class="s">&quot;sms://&quot;</span> <span class="o">+</span> <span class="n">ms</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="n">b</span><span class="p">],</span> <span class="n">ms</span><span class="p">[</span><span class="mi">2</span><span class="p">][</span><span class="n">b</span><span class="p">]);</span> <span class="c1">// sms://</span>
  <span class="k">if</span> <span class="p">(</span><span class="n">b</span> <span class="o">==</span> <span class="n">count_query</span><span class="p">)</span> <span class="n">b</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span> <span class="k">else</span> <span class="n">b</span> <span class="o">+=</span> <span class="mi">1</span><span class="p">;</span>
<span class="p">}</span>
</pre></div>


<p>The above code is associated with the class SM.class. With the following source code:</p>
<div class="highlight"><pre><span class="n">public</span> <span class="k">static</span> <span class="kt">int</span> <span class="nf">send</span><span class="p">(</span><span class="n">String</span> <span class="n">s</span><span class="p">,</span> <span class="n">String</span> <span class="n">s1</span><span class="p">)</span>
<span class="p">{</span>
   <span class="k">if</span> <span class="p">(</span><span class="n">isSending</span><span class="p">)</span> <span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
      <span class="n">new</span> <span class="n">SM</span><span class="p">(</span><span class="n">s</span><span class="p">,</span> <span class="n">s1</span><span class="p">);</span>
   <span class="k">return</span> <span class="o">-</span><span class="mi">1</span><span class="p">;</span>
<span class="p">}</span>
<span class="n">public</span> <span class="nf">SM</span><span class="p">(</span><span class="n">String</span> <span class="n">s</span><span class="p">,</span> <span class="n">String</span> <span class="n">s1</span><span class="p">)</span> <span class="p">{</span>
 <span class="n">success</span> <span class="o">=</span> <span class="nb">false</span><span class="p">;</span>
 <span class="n">isSending</span> <span class="o">=</span> <span class="nb">true</span><span class="p">;</span>
 <span class="n">this</span><span class="p">.</span><span class="n">destination</span> <span class="o">=</span> <span class="n">s</span><span class="p">;</span>
 <span class="n">this</span><span class="p">.</span><span class="n">message</span> <span class="o">=</span> <span class="n">s1</span><span class="p">;</span>
 <span class="n">try</span> <span class="p">{</span>
      <span class="n">Thread</span> <span class="kr">thread</span> <span class="o">=</span> <span class="n">new</span> <span class="n">Thread</span><span class="p">(</span><span class="n">this</span><span class="p">);</span>
      <span class="kr">thread</span><span class="p">.</span><span class="n">start</span><span class="p">();</span>
 <span class="p">}</span>
 <span class="n">catch</span> <span class="p">(</span><span class="n">Exception</span> <span class="n">exception</span><span class="p">)</span> <span class="p">{</span>
 <span class="n">isSending</span> <span class="o">=</span> <span class="nb">false</span><span class="p">;</span>
<span class="p">}</span>
</pre></div>


<p>The above code is checking if the message and the destination is correct<br>
and if the message is sent. Coloration is more like the first public static method named <em>send</em> with the two string values of <em>s</em> and <em>s1</em>.</p>
<p>All the above extraction was finished by JD-Gui version 0.3.3 and JD-Core version 0.6.0 and using the&nbsp;menu bar for search, with the criteria that will meet our needs.</p>
<p>The bellow are executable results presented, done by eclipse after compiling the code:</p>
<div class="highlight"><pre><span class="o">/</span><span class="mi">0</span><span class="n">SIF</span><span class="o">|</span><span class="mi">6</span><span class="n">XI8ULE</span><span class="o">|</span><span class="n">YNLD5QDA6WM</span><span class="o">|</span><span class="n">YJ90RL</span><span class="o">/+</span><span class="n">WPJDAFY2</span> <span class="n">DC3QJ</span><span class="o">/+</span><span class="mi">3</span><span class="n">RKA</span><span class="o">/</span><span class="mi">5</span><span class="n">YPA0MD</span><span class="o">-</span><span class="mi">5</span><span class="n">QFD</span>
<span class="k">while</span> <span class="mi">7375</span><span class="o">/</span><span class="mi">88600168904</span><span class="o">|</span><span class="mi">7202</span><span class="o">/</span><span class="mi">65510006691</span><span class="o">|</span><span class="mi">1899</span><span class="o">/</span><span class="n">FTEME</span> <span class="mi">1283</span><span class="o">|</span><span class="mi">8385</span><span class="o">/</span><span class="mi">88600168904</span><span class="o">|</span>
<span class="mi">1</span> <span class="mi">16</span>
<span class="mi">2</span> <span class="mi">33</span>
<span class="mi">3</span> <span class="mi">49</span>
<span class="mi">4</span> <span class="mi">66</span>
<span class="mi">7375</span> <span class="mi">88600168904</span> <span class="c1">//sms://7375</span>
<span class="mi">7202</span> <span class="mi">65510006691</span> <span class="c1">//sms://7202</span>
<span class="mi">1899</span> <span class="n">fteme</span> <span class="mi">1283</span> <span class="c1">//sms://1899</span>
<span class="mi">8385</span> <span class="mi">88600168904</span> <span class="c1">//sms://8385</span>
<span class="n">decoded</span>
<span class="mi">36</span>
<span class="mi">7375</span> <span class="mi">88600168904</span>
<span class="mi">42</span>
<span class="mi">7202</span> <span class="mi">65510006691</span>
<span class="mi">48</span>
<span class="mi">1899</span> <span class="n">fteme</span> <span class="mi">1283</span>
<span class="mi">54</span>
</pre></div>


<p>From the above presented results after compiling the code we have identify the number of SMSes URLs and in addition the exact URLs.</p>
<h1>CONCLUSION</h1>
<p>We live in a world where nowadays for everyday work, communication, etc. the most essentially tool is our mobile phones, smart phones, etc. We used them for communication, sending SMS, playing games, checking e-mails, social networking, bank transaction, etc. That is why today there are hundreds and rising everyday mobile malware files. We need to make sure what we are installing in our devices, what kind of games, applications, etc. Therefore, this post will help for a people who are interested to learn basic of how to analysis and identify malware files for mobile phones. However, this is only a basic, and a good guide to give you an idea of what kind of tools, applications you should have. This task is done only for a Java source code mobile malware game.</p>
<p>Furthermore, from the above section we have identify the number of SMSes that are sent and to what numbers. The total number of SMSes is 4 and sent to the following URLs:</p>
<div class="highlight"><pre><span class="nl">sms:</span><span class="c1">//7375</span>
<span class="nl">sms:</span><span class="c1">//7202</span>
<span class="nl">sms:</span><span class="c1">//1899</span>
<span class="nl">sms:</span><span class="c1">//8385</span>
</pre></div>


<p>Finally, mobile malware is rising and it is about to explode, therefore users need education[1]. By delivering basic and advance mobile malware security awareness program we will have less malware attacks and better security policy into everyday mobile, smart phones usage.</p>
<h1>Bibliography</h1>
<p>[1] Chris Martin, Mobile malware is about to explode, users need education, 20 Jan. 2012, <a href="http://www.theinquirer.net/inquirer/opinion/2140338/mobile-malware-explode-users-education" target="_blank">http://www.theinquirer.net/inquirer/opinion/2140338/mobile-malware-explode-users-education</a></p>	

	</article>

    <p>
	<a href="https://twitter.com/share" class="twitter-share-button" data-via="" data-lang="en" data-size="large" data-related="">Tweet</a>
	<script>!function(d,s,id){var js,fjs=d.getElementsByTagName(s)[0];if(!d.getElementById(id)){js=d.createElement(s);js.id=id;js.src="//platform.twitter.com/widgets.js";fjs.parentNode.insertBefore(js,fjs);}}(document,"script","twitter-wjs");</script>
	</p>


		  </div>	
		  
		  <div class="sidebar">

	        <nav>
	          <h2>Categories</h2>
	          <ul>
	              <li ><a href="../../../../category/awareness.html">awareness</a></li>
	              <li ><a href="../../../../category/camp.html">camp</a></li>
	              <li ><a href="../../../../category/collectivistic.html">collectivistic</a></li>
	              <li ><a href="../../../../category/company.html">company</a></li>
	              <li ><a href="../../../../category/conference.html">conference</a></li>
	              <li ><a href="../../../../category/cyber-crime.html">cyber crime</a></li>
	              <li ><a href="../../../../category/cyber-security.html">cyber security</a></li>
	              <li ><a href="../../../../category/cyberwar.html">cyberwar</a></li>
	              <li ><a href="../../../../category/cyberwarfare.html">cyberwarfare</a></li>
	              <li ><a href="../../../../category/digital-divide.html">digital divide</a></li>
	              <li ><a href="../../../../category/hate-speech.html">hate speech</a></li>
	              <li ><a href="../../../../category/hate-speechnetwork-security.html">hate speechnetwork security</a></li>
	              <li ><a href="../../../../category/honeypot.html">honeypot</a></li>
	              <li ><a href="../../../../category/human-communication.html">human communication</a></li>
	              <li ><a href="../../../../category/human-computer-interaction.html">human computer interaction</a></li>
	              <li ><a href="../../../../category/human-rights.html">human rights</a></li>
	              <li ><a href="../../../../category/ids.html">IDS</a></li>
	              <li ><a href="../../../../category/interview.html">interview</a></li>
	              <li ><a href="../../../../category/leaks.html">leaks</a></li>
	              <li class="active"><a href="../../../../category/malware.html">malware</a></li>
	              <li ><a href="../../../../category/network-security.html">network security</a></li>
	              <li ><a href="../../../../category/password-attacks.html">password attacks</a></li>
	              <li ><a href="../../../../category/regular-expression.html">regular expression</a></li>
	              <li ><a href="../../../../category/research.html">research</a></li>
	              <li ><a href="../../../../category/risk-assessment.html">risk assessment</a></li>
	              <li ><a href="../../../../category/script-kiddie.html">script kiddie</a></li>
	              <li ><a href="../../../../category/security-programing.html">security programing</a></li>
	              <li ><a href="../../../../category/security-testing.html">security testing</a></li>
	              <li ><a href="../../../../category/social-networks.html">social networks</a></li>
	              <li ><a href="../../../../category/texworks.html">texworks</a></li>
	              <li ><a href="../../../../category/thinkpad.html">thinkpad</a></li>
	              <li ><a href="../../../../category/virtual-life.html">virtual life</a></li>
	              <li ><a href="../../../../category/wireless-security.html">wireless security</a></li>
	              <li ><a href="../../../../category/wordpress.html">wordpress</a></li>
	          </ul>
	        </nav>

	          <aside>
	          <h2>Social</h2>
			    <ul class="social">
				  <li><a href="https://www.linkedin.com/in/tpredrag">Linkedin</a><i></i></li>
				  <li><a href="https://twitter.com/stepcellwolf">Twitter</a><i></i></li>
				  <li><a href="https://github.com/stepcellwolf/">Github</a><i></i></li>
			    </ul>
			  </aside>

	          <aside>
	            <h2>Blogroll</h2>
	            <ul>
	                <li><a href="http://getpelican.com/">Pelican</a></li>
	                <li><a href="http://python.org/">Python.org</a></li>
	                <li><a href="http://jinja.pocoo.org/">Jinja2</a></li>
	                <li><a href="#">You can modify those links in your config file</a></li>
	            </ul>
	          </aside>

		  </div>

	  </div>

      <footer>
		<p role="contentinfo">
		  © 2013 Predrag TASEVSKI - Pece - Proudly powered by <a href="http://alexis.notmyidea.org/pelican/">pelican</a>. Theme <a href="https://github.com/fle/pelican-simplegrey">pelican-simplegrey</a>.
    	</p>

	  </footer>	

	</div>
	

</body>
</html>