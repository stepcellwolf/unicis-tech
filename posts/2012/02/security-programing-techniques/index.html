<!DOCTYPE html>
<html lang="en"
>
<head>
    <title>Security Programing Techniques - Predrag TASEVSKI - Pece</title>
    <!-- Using the latest rendering mode for IE -->
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">



<link rel="canonical" href="../../../../posts/2012/02/security-programing-techniques/">

        <meta name="author" content="Predrag TASEVSKI - Pece" />
        <meta name="keywords" content="ASP.NET,bash,C#,cyber security,HQL,java,JDBC,Perl,PHP5,python,Ruby on Rail,security,security model,Unix,windows 7" />
        <meta name="description" content="INTRODUCTION The main goal of this post is to introduce the reader with the security programing techniques into deferent program languages and operating system security models. The post is introducing four following topics: Session storage’s in Ruby on Rail Parameterized statements into Java with JDBC, C# with ASP.NET ..." />

    <!-- Enable latex plugin -->




    <!-- Bootstrap -->
        <link rel="stylesheet" href="../../../../theme/css/bootstrap.min.css" type="text/css"/>
    <link href="../../../../theme/css/font-awesome.min.css" rel="stylesheet">

    <link href="../../../../theme/css/pygments/native.css" rel="stylesheet">
    <link rel="stylesheet" href="../../../../theme/css/style.css" type="text/css"/>

        <link href="../../../../feeds/all.atom.xml" type="application/atom+xml" rel="alternate"
              title="Predrag TASEVSKI - Pece ATOM Feed"/>


        <link href="../../../../feeds/category/security programing.atom.xml" type="application/atom+xml" rel="alternate"
              title="Predrag TASEVSKI - Pece security programing ATOM Feed"/>

</head>
<body>

<div class="navbar navbar-default navbar-fixed-top" role="navigation">
    <div class="container">
        <div class="navbar-header">
            <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".navbar-ex1-collapse">
                <span class="sr-only">Toggle navigation</span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
            </button>
            <a href="../../../../" class="navbar-brand">
Predrag TASEVSKI - Pece            </a>
        </div>
        <div class="collapse navbar-collapse navbar-ex1-collapse">
            <ul class="nav navbar-nav">
                         <li><a href="../../../../pages/about.html">
                             About
                          </a></li>
                         <li><a href="../../../../pages/cv.html">
                             CV
                          </a></li>
                         <li><a href="../../../../pages/photography.html">
                             Photography
                          </a></li>
                         <li><a href="../../../../pages/projects.html">
                             Projects
                          </a></li>
                         <li><a href="../../../../pages/publications.html">
                             Publications
                          </a></li>
                         <li><a href="../../../../pages/talks.html">
                             Talks
                          </a></li>
                         <li><a href="../../../../pages/teaching.html">
                             Teaching
                          </a></li>
            </ul>
            <ul class="nav navbar-nav navbar-right">
                <li><a href="../../../../archives.html"><i class="fa fa-th-list"></i><span class="icon-label">Archives</span></a></li>
            </ul>
        </div>
        <!-- /.navbar-collapse -->
    </div>
</div> <!-- /.navbar -->

<div class="container">
    <div class="row">
        <div class="col-sm-9">

    <section id="content">
        <article>
            <header class="page-header">
                <h1>
                    <a href="../../../../posts/2012/02/security-programing-techniques/"
                       rel="bookmark"
                       title="Permalink to Security Programing Techniques">
                        Security Programing Techniques
                    </a>
                </h1>
            </header>
            <div class="entry-content">
                <div class="panel">
                    <div class="panel-body">
<footer class="post-info">
    <span class="label label-default">Date</span>
    <span class="published">
        <i class="fa fa-calendar"></i><time datetime="2012-02-21T00:00:00"> mar., 21 févr. 2012</time>
    </span>



<span class="label label-default">Tags</span>
	<a href="../../../../tag/aspnet.html">ASP.NET</a>
        /
	<a href="../../../../tag/bash.html">bash</a>
        /
	<a href="../../../../tag/c.html">C#</a>
        /
	<a href="../../../../tag/cyber-security.html">cyber security</a>
        /
	<a href="../../../../tag/hql.html">HQL</a>
        /
	<a href="../../../../tag/java.html">java</a>
        /
	<a href="../../../../tag/jdbc.html">JDBC</a>
        /
	<a href="../../../../tag/perl.html">Perl</a>
        /
	<a href="../../../../tag/php5.html">PHP5</a>
        /
	<a href="../../../../tag/python.html">python</a>
        /
	<a href="../../../../tag/ruby-on-rail.html">Ruby on Rail</a>
        /
	<a href="../../../../tag/security.html">security</a>
        /
	<a href="../../../../tag/security-model.html">security model</a>
        /
	<a href="../../../../tag/unix.html">Unix</a>
        /
	<a href="../../../../tag/windows-7.html">windows 7</a>
    
</footer><!-- /.post-info -->                    </div>
                </div>
                <h1>INTRODUCTION</h1>
<p>The main goal of this post is to introduce the reader with the security programing techniques into deferent  program languages and operating system security models. The post is introducing four following topics:</p>
<ol>
<li>Session storage’s in Ruby on Rail</li>
<li>Parameterized statements into Java with JDBC, C# with ASP.NET, PHP5, php-mysqli, Perl, Python and Hibernate Query Language (HQL)</li>
<li>Unix permission model, Unix ACL and Windows 7 security model</li>
<li>Finding all the security vulnerabilities in bash script</li>
</ol>
<p>Each topic will be divided into own section, where at the end of each topic we stated the reference and additional reading material. The source code, scrips and the additional task were given by the lecture. However this will help the readers and people interesting into programing for further work and involvement with the above topics.</p>
<h1>1. Session storage’s in Ruby on Rail</h1>
<p>Session in Rails is a hash-like structure which allows you to store data across requests. Sessions can hold any kind of data object (with some limitations) because they store data using Data Marshalling.Session in rails it is not a hash. Session creates new instant of session in every time new user visit the site. Recommendation is to not store large objects in a session and critical data should not be stored in session.Rails way of
implementing session is: </p>
<ol>
<li>session_id is a 32 hex character MD5 hash based upon time, random number and constant string. It is stored in cookie at client browser. Rails provides transparent support for session_id.</li>
<li>Session storage discussed below.</li>
</ol>
<p>Ruby on Rails provides with many session storage option:</p>
<ol>
<li>PStore – it implements a file based persistence mechanism based on a Hash. User code can store hierarchies of Ruby objects (values) into the data store file by name (keys). An object hierarchy may be just a single object. User code may later read values back from the data store or even update data, as needed. The files that are stored are usually located in the tmp/sessions folder for the Rails app. The main downside of using the PStore is that you will have to do some session-pruning periodically because performance decreases as the number of sessions stored increases.</li>
<li>ActiveRecordStore – keeps the session id and hash in a database table and saves and retrieves the hash on every request.</li>
<li>CookieStore – it saves the session hash directly in a cookie on the client-side. The server retrieves the session hash from the cookie and eliminates the need for a session id. Cookie-based sessions are just faster to retrieve and process than hitting the file-system on every request, were it was previously. Cookies are generally limited to 4K in size. While not an issue for most (proper) usage of the session, this could be a legitimate limit for some scenarios. If your application abuses the session, you’ll need to decide on a different session store that are available. The cookie has a SHA512 fingerprint attached and is hashed with a secret stored up on the server and there are, however, derivatives of CookieStore which encrypt the session hash, so the client cannot see it.</li>
<li>DRbStore – it store uses distributed Ruby to store a user’s session data. The performance is great, but it requires a bit more setup than the other stores.</li>
<li>FileStore – This store keeps the fragments on the hard disk instead of in memory. It works well if you have a lot of file storage and have outgrown the MemoryStore.</li>
<li>MemoryStore – keeps your session data in server memory. It keeps the fragments in your application’s memory, which can potentially take up a lot of memory on your server. It is used by default, but it is hard to manage and scale if your application becomes popular.</li>
</ol>
<p><strong>Note:</strong> Ruby on Rail CookieStore is available only in edge rails. PStore is the default option for stable release, whereas its CookieStore as default for edge rails.</p>
<h2>Reference</h2>
<p>Ruby On Rails Security Guide, From: <a href="http://guides.rubyonrails.org/security.html" target="_blank">http://guides.rubyonrails.org/security.html</a></p>
<p>Sessions and cookies in Ruby on Rails, From: <a href="http://www.quarkruby.com/2007/10/21/%20sessions-and-cookies-in-ruby-on-rails#sstorage" target="_blank">http://www.quarkruby.com/2007/10/21/sessions-and-cookies-in-ruby-on-rails#sstorage</a></p>
<p>What’s New in Edge Rails: Cookie Based Sessions are the New Default, From: <a href="http://ryandaigle.com/articles/2007/2/21/what-s-new-in-edge-rails-cookie-based-sessions" target="_blank">http://ryandaigle.com/articles/2007/2/21/what-s-new-in-edge-rails-cookie-based-sessions</a></p>
<h1>2. Parameterized statements into Java with JDBC, C# with ASP.NET, PHP5, php-mysqli, Perl, Python and Hibernate Query Language (HQL)</h1>
<p>For this task we will take a look at the parameterized statement API-s and we will find out and document how much does each of them protect against the following possible misuses of SQL statements:</p>
<ul>
<li>String injection (quotes, double quotes)</li>
<li>SQL statement injection (expression syntax etc)</li>
<li>Out of range integers</li>
<li>Blind SQL injection</li>
</ul>
<h2>Java with JDBC</h2>
<div class="highlight"><pre><span class="n">PreparedStatement</span> <span class="n">prep</span> <span class="o">=</span>
<span class="n">conn</span><span class="p">.</span><span class="n">prepareStatement</span><span class="p">(</span><span class="s">&quot;SELECT * FROM</span>
<span class="n">USERS</span>
<span class="n">WHERE</span> <span class="n">USERNAME</span><span class="o">=?</span> <span class="n">AND</span> <span class="n">PASSWORD</span><span class="o">=?</span><span class="s">&quot;);</span>
<span class="n">prep</span><span class="p">.</span><span class="n">setString</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">username</span><span class="p">);</span>
<span class="n">prep</span><span class="p">.</span><span class="n">setString</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="n">password</span><span class="p">);</span>
<span class="n">prep</span><span class="p">.</span><span class="n">executeQuery</span><span class="p">();</span>
</pre></div>


<p>There are no possibilities of string injection because of the filtering the statements. It enables users’ input to be initially filtered instead&nbsp; of directly embedding it in the SQL statements. In this example is that the each parameter is a scalar, not a table, where the user input is then assigned (bound) to a parameter. It is a good idea if the character range is limited. Another thing that can be done to avoid SQL injection is to convert numeric values to integers before parsing them into the SQL statement. Or using ISNUMERIC to verify that they are integers.</p>
<h2>C# with ASP.NET</h2>
<div class="highlight"><pre><span class="n">using</span> <span class="p">(</span><span class="n">SqlCommand</span> <span class="n">myCommand</span> <span class="o">=</span>
<span class="n">new</span> <span class="n">SqlCommand</span><span class="p">(</span><span class="s">&quot;SELECT * FROM USERS</span>
<span class="n">WHERE</span>
<span class="n">USERNAME</span><span class="o">=</span><span class="err">@</span><span class="n">user</span> <span class="n">AND</span>
<span class="n">PASSWORD</span><span class="o">=</span><span class="n">HASHBYTES</span><span class="p">(</span><span class="err">’</span><span class="n">SHA1</span><span class="err">’</span><span class="p">,</span> <span class="err">@</span><span class="n">pwd</span><span class="p">)</span><span class="s">&quot;,</span>
<span class="n">myConnection</span><span class="p">))</span>
<span class="p">{</span>
<span class="n">myCommand</span><span class="p">.</span><span class="n">Parameters</span><span class="p">.</span><span class="n">AddWithValue</span><span class="p">(</span><span class="s">&quot;@user&quot;</span><span class="p">,</span>
<span class="n">user</span><span class="p">);</span>
<span class="n">myCommand</span><span class="p">.</span><span class="n">Parameters</span><span class="p">.</span><span class="n">AddWithValue</span><span class="p">(</span><span class="s">&quot;@pwd&quot;</span><span class="p">,</span>
<span class="n">pass</span><span class="p">);</span>
<span class="n">myConnection</span><span class="p">.</span><span class="n">Open</span><span class="p">();</span>
<span class="n">SqlDataReader</span> <span class="n">myReader</span> <span class="o">=</span>
<span class="n">myCommand</span><span class="p">.</span><span class="n">ExecuteReader</span><span class="p">();</span>
<span class="p">...</span>
<span class="p">}</span>
</pre></div>


<p>The placeholder – @user and the hashbyte value of password @pws – has become part&nbsp; if the hardcoded SQL. At runtime, the value provided by the querystring is passed to the database along with the hardcoded SQL, and the database will check the Username and password field as it attempts to bind the parameter value to it. This ensures a level of strong typing. If the parameter value is not the right type for the database field (a string, or numeric that’s out of range for the field type), the database will be unable to convert it to the right type and will reject it. If the target field datatype is a string (char, nvarchar etc), the parameter value will be “stringified” automatically, which includes escaping single quotes. It will not form part of the SQL statement to be executed.</p>
<h2>PHP5</h2>
<div class="highlight"><pre><span class="err">$</span><span class="n">db</span> <span class="o">=</span> <span class="n">new</span> <span class="n">PDO</span><span class="p">(</span><span class="err">’</span><span class="n">pgsql</span><span class="o">:</span><span class="n">dbname</span><span class="o">=</span><span class="n">database</span><span class="err">’</span><span class="p">);</span>
<span class="err">$</span><span class="n">stmt</span> <span class="o">=</span> <span class="err">$</span><span class="n">db</span><span class="o">-</span><span class="n">prepare</span><span class="p">(</span><span class="s">&quot;SELECT priv FROM testUsers WHERE username=:username AND password=:password&quot;</span><span class="p">);</span>
<span class="err">$</span><span class="n">stmt</span><span class="o">-</span><span class="n">bindParam</span><span class="p">(</span><span class="err">’</span><span class="o">:</span><span class="n">username</span><span class="err">’</span><span class="p">,</span> <span class="err">$</span><span class="n">user</span><span class="p">);</span>
<span class="err">$</span><span class="n">stmt</span><span class="o">-</span><span class="n">bindParam</span><span class="p">(</span><span class="err">’</span><span class="o">:</span><span class="n">password</span><span class="err">’</span><span class="p">,</span> <span class="err">$</span><span class="n">pass</span><span class="p">);</span>
<span class="err">$</span><span class="n">stmt</span><span class="o">-</span><span class="n">execute</span><span class="p">();</span>
</pre></div>


<p>In this example to protect against SQL injection, it is used an input not directly to be&nbsp; embedded in SQL statements. Instead, it is used an parameterized statements (preferred), or user input must be carefully escaped or filtered. This example shows and parameterized example/statement in php v. 5 and PDO database to protect from SQL injections and blind SQL injections.</p>
<h2>PHP-MySQLi</h2>
<div class="highlight"><pre><span class="err">$</span><span class="n">db</span> <span class="o">=</span> <span class="n">new</span> <span class="n">mysqli</span><span class="p">(</span><span class="s">&quot;host&quot;</span><span class="p">,</span> <span class="s">&quot;user&quot;</span><span class="p">,</span> <span class="s">&quot;pass&quot;</span><span class="p">,</span>
<span class="s">&quot;database&quot;</span><span class="p">);</span>
<span class="err">$</span><span class="n">stmt</span> <span class="o">=</span> <span class="err">$</span><span class="n">db</span> <span class="o">-</span> <span class="n">prepare</span><span class="p">(</span><span class="s">&quot;SELECT priv FROM testUsers WHERE username=? AND password=?&quot;</span><span class="p">);</span>
<span class="err">$</span><span class="n">stmt</span> <span class="o">-</span>  <span class="n">bind_param</span><span class="p">(</span><span class="s">&quot;ss&quot;</span><span class="p">,</span> <span class="err">$</span><span class="n">user</span><span class="p">,</span> <span class="err">$</span><span class="n">pass</span><span class="p">);</span>
<span class="err">$</span><span class="n">stmt</span> <span class="o">-</span> <span class="n">execute</span><span class="p">();</span>
</pre></div>


<p>Same as above but this time it is used the vendor-specific methods; for instance, using the mysqli extension for MySQL 4.1 and create parameterized statements to protect from the SQL injection.</p>
<h2>Perl</h2>
<div class="highlight"><pre><span class="k">use</span> <span class="n">DBI</span><span class="p">;</span>
<span class="k">my</span> <span class="nv">$db</span> <span class="o">=</span> <span class="n">DBI</span><span class="o">-</span>
<span class="nb">connect</span><span class="p">(</span><span class="err">’</span><span class="n">DBI:mysql:mydatabase:host</span><span class="err">’</span><span class="p">,</span> <span class="err">’</span><span class="n">login</span><span class="err">’</span><span class="p">,</span> <span class="err">’</span><span class="n">password</span><span class="err">’</span><span class="p">);</span>
<span class="nv">$statment</span> <span class="o">=</span> <span class="nv">$db</span><span class="o">-&amp;</span><span class="n">amp</span><span class="p">;</span><span class="n">amp</span><span class="p">;</span><span class="n">amp</span><span class="p">;</span><span class="n">amp</span><span class="p">;</span><span class="n">amp</span><span class="p">;</span><span class="ow">gt</span><span class="p">;</span><span class="n">prepare</span><span class="p">(</span><span class="s">&quot;UPDATE players SET name = ?, score = ?, active = ? WHERE jerseyNum = ?&quot;</span><span class="p">);</span>
<span class="nv">$rows_affected</span> <span class="o">=</span> <span class="nv">$statment</span><span class="o">-&amp;</span><span class="n">amp</span><span class="p">;</span><span class="n">amp</span><span class="p">;</span><span class="n">amp</span><span class="p">;</span><span class="n">amp</span><span class="p">;</span><span class="n">amp</span><span class="p">;</span><span class="ow">gt</span><span class="p">;</span><span class="n">execute</span><span class="p">(</span><span class="s">&quot;Smith, Steve&quot;</span><span class="p">,</span> <span class="mi">42</span><span class="p">,</span> <span class="err">’</span><span class="n">true</span><span class="err">’</span><span class="p">,</span> <span class="mi">99</span><span class="p">);</span>
</pre></div>


<p>Automatically “sanitize” input to parameterized SQL statements to avoid the catastrophic&nbsp; database attacks.</p>
<h2>Python</h2>
<div class="highlight"><pre><span class="n">import</span> <span class="n">sqlite3</span>
<span class="n">db</span> <span class="o">=</span> <span class="n">sqlite3</span><span class="p">.</span><span class="n">connect</span><span class="p">(</span><span class="err">’</span><span class="o">:</span><span class="n">memory</span><span class="o">:</span><span class="err">’</span><span class="p">)</span>
<span class="n">db</span><span class="p">.</span><span class="n">execute</span><span class="p">(</span><span class="err">’</span><span class="n">update</span> <span class="n">players</span> <span class="n">set</span> <span class="n">name</span><span class="o">=:</span><span class="n">name</span><span class="p">,</span> <span class="n">score</span><span class="o">=:</span><span class="n">score</span><span class="p">,</span>
<span class="n">active</span><span class="o">=:</span><span class="n">active</span> <span class="n">where</span> <span class="n">jerseyNum</span><span class="o">=:</span><span class="n">num</span><span class="err">’</span><span class="p">,</span> <span class="p">{</span><span class="err">’</span><span class="n">num</span><span class="err">’</span><span class="o">:</span> <span class="mi">100</span><span class="p">,</span> <span class="err">’</span><span class="n">name</span><span class="err">’</span><span class="o">:</span> <span class="err">’</span><span class="n">John</span> <span class="n">Doe</span><span class="err">’</span><span class="p">,</span> <span class="err">’</span><span class="n">active</span><span class="err">’</span><span class="o">:</span> <span class="n">False</span><span class="p">,</span> <span class="err">’</span><span class="n">score</span><span class="err">’</span><span class="o">:</span> <span class="o">-</span><span class="mi">1</span><span class="p">})</span>
</pre></div>


<p>It is parameterized statement with an example of named placeholders. Which insure to avoid the SQL injections and database attacks.</p>
<h2>Hibernate Query Language (HQL)</h2>
<div class="highlight"><pre><span class="n">Query</span> <span class="n">safeHQLQuery</span> <span class="o">=</span> <span class="n">session</span><span class="p">.</span><span class="n">createQuery</span><span class="p">(</span>
<span class="s">&quot;from Inventory where productID=:productid&quot;</span><span class="p">);</span>
<span class="n">safeHQLQuery</span><span class="p">.</span><span class="n">setParameter</span><span class="p">(</span><span class="s">&quot;productid&quot;</span><span class="p">,</span> <span class="n">userSuppliedParameter</span><span class="p">);</span>
</pre></div>


<p>Unsafe example: Query unsafeHQLQuery = session.createQuery(“from Inventory where productID=’”+userSuppliedParameter+”‘”); The example from left it’s used prepared statement approach because all the SQL code stays within the application. This makes your application relatively database independent. However, other options allow you to store all the SQL code in the database itself, which has both security and non-security advantages and the approach is called Stored Procedure</p>
<h1>3. Unix permission model, Unix ACL and Windows 7 security model</h1>
<p>In this topic we will describe two security set-ups that can not be expressed with traditional Unix permission model, UNIX ACL and Windows 7 security model.</p>
<h2>Unix permission model</h2>
<ul>
<li>Giving an different permission to different users in the same group</li>
<li>Read and write permission/access to all groups, which gives and access to the ‘private files’, and you can gain access through a root account by an unwanted user, which brings and complete breach of the system</li>
</ul>
<h2>Unix ACL- enabled permission model</h2>
<ul>
<li>If the user has permission over the file, he can read/write and delete it, which brings that it is not possible to give ‘some’ permission to the user.</li>
<li>ACL’s are not very portable and are very hard to maintain. For instance good example is transferring of files with ACL’s between different of Unix systems is an exercise for brave person, even if the both file systems support them. Which brings a difficulty to maintain for existing files for instance backup, restore, copying, etc.</li>
</ul>
<h2>Windows 7 security model</h2>
<ul>
<li>As a standard user you can perform an action that requires administrator privileges by the UAC(User Access Control), which is controlled by the Admin Approval Mode. It can be turn off and on. Every time when you need to gain an access of the administration privileges it will be prompt a dialog box to gain and provide the password for an access. Therefore in the medium settings with any malware could turn it off.</li>
<li>And the settings of the UAC are in medium mode not off, still brings an opportunity to being turn off by the malware.</li>
</ul>
<h1>4. Finding all the security vulnerabilities in bash script</h1>
<p>In this topic we will find all the possible vulnerabilities into the following bash script:</p>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22
23</pre></div></td><td class="code"><div class="highlight"><pre><span class="c">#!/bin/sh</span>
<span class="c"># remove files with name pattern matching regexp</span>
<span class="k">if</span> <span class="o">[</span> x<span class="nv">$1</span> <span class="o">=</span> x <span class="o">]</span>; <span class="k">then</span>
<span class="c"># if [[ x$1 = x ]]</span>
<span class="nb">echo</span> -n <span class="s2">&quot;Please enter directory name: &quot;</span>
<span class="nb">read </span>dir
<span class="k">else</span>
<span class="nv">dir</span><span class="o">=</span><span class="nv">$1</span>
<span class="k">fi</span>
<span class="k">if</span> <span class="o">[</span> x<span class="nv">$2</span> <span class="o">=</span> x <span class="o">]</span>; <span class="k">then</span>
<span class="c"># if [[ x$2 = x ]]</span>
<span class="nb">echo</span> -n <span class="s2">&quot;Please enter pattern: &quot;</span>
<span class="nb">read </span>pattern
<span class="k">else</span>
<span class="nv">pattern</span><span class="o">=</span><span class="nv">$2</span>
<span class="k">fi</span>
find <span class="nv">$dir</span> &amp;amp;amp;amp;amp;amp;gt; /tmp/listing
<span class="c"># can use &amp;amp;amp;amp;amp;amp;gt;&amp;amp;amp;amp;amp;amp;gt; or print the output first before</span>
<span class="nv">cmd</span><span class="o">=</span><span class="s1">&#39;rm `grep &#39;</span><span class="nv">$pattern</span><span class="s1">&#39; /tmp/listing`&#39;</span> <span class="c">#+the command is execute</span>
<span class="nb">echo</span> <span class="s2">&quot;Running command $cmd&quot;</span>
<span class="nb">eval</span> <span class="nv">$cmd</span> //it converts string in <span class="nb">command</span>
rm /tmp/listing
<span class="nb">exit </span>0
</pre></div>
</td></tr></table>

<p>We should avoid temporary file, instead we should use pipes [2]. We should avoid eval [2].</p>
<p>Using the double brackets, instead of single one <code>[[... ]]</code> it is comment on the script above [1]. $REPLY can be used to read the previous value of the dir and pattern variable [1]. We can use instead of find, while read contracture (loop) [1]. Find – can be set with a cycle, for or while to check the validation of the file and the directory/path, also comment on the script or using <code>“$pattern” /tmp/listing</code> [1]. No sensitization of the input, the user can put any value and therefore, execute any command to create another command. As we can see above the script it looks like that it is security vulnerable. If we want to implement the security in the script we should implement the above changes into the script.</p>
<h2>Reference</h2>
<p>[1] Mendel Cooper, 30 April 2011. Advanced Bash-Scripting Guide; An in-depth exploration of the art of shell scripting. Retrieved from: <a href="http://tldp.org/LDP/abs/html/index.html" target="_blank">http://tldp.org/LDP/abs/html/index.html</a></p>
<p>[2] Lecture 8 slides Scripting, Meelis Roos. Retrieved from file: 08-scripting.pdf</p>
            </div>
            <!-- /.entry-content -->
    <hr/>
    <section class="comments" id="comments">
        <h2>Comments</h2>

        <div id="disqus_thread"></div>
        <script type="text/javascript">
            /* * * CONFIGURATION VARIABLES: EDIT BEFORE PASTING INTO YOUR WEBPAGE * * */
            var disqus_shortname = 'predragtasevski.com'; // required: replace example with your forum shortname

                    var disqus_identifier = 'security-programing-techniques';
                var disqus_url = '../../../../posts/2012/02/security-programing-techniques/';

            var disqus_config = function () {
                this.language = "en";
            };

            /* * * DON'T EDIT BELOW THIS LINE * * */
            (function () {
                var dsq = document.createElement('script');
                dsq.type = 'text/javascript';
                dsq.async = true;
                dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
                (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
            })();
        </script>
        <noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by
            Disqus.</a></noscript>
        <a href="http://disqus.com" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a>

    </section>
        </article>
    </section>

        </div>
        <div class="col-sm-3 well well-sm" id="sidebar">

<aside>
    <section>
        <ul class="list-group list-group-flush">
                <li class="list-group-item"><h4><i class="fa fa-home fa-lg"></i><span class="icon-label">Social</span></h4>
                  <ul class="list-group" id="social">
                    <li class="list-group-item"><a href="https://www.linkedin.com/in/tpredrag"><i class="fa fa-linkedin-square fa-lg"></i> Linkedin</a></li>
                    <li class="list-group-item"><a href="https://twitter.com/stepcellwolf"><i class="fa fa-twitter-square fa-lg"></i> Twitter</a></li>
                    <li class="list-group-item"><a href="https://github.com/stepcellwolf/"><i class="fa fa-github-square fa-lg"></i> Github</a></li>
                    <li class="list-group-item"><a href="https://plus.google.com/u/0/+PredragTasevski/posts/p/pub"><i class="fa fa-google-plus-square fa-lg"></i> Google+</a></li>
                    <li class="list-group-item"><a href="https://www.flickr.com/photos/29569957@N00"><i class="fa fa-flickr fa-lg"></i> Flickr</a></li>
                    <li class="list-group-item"><a href="/feeds/all.atom.xml"><i class="fa fa-rss-square fa-lg"></i> RSS</a></li>
                  </ul>
                </li>



                <li class="list-group-item"><a href="../../../../"><h4><i class="fa fa-tags fa-lg"></i><span class="icon-label">Tags</span></h4></a>
                    <ul class="list-group " id="tags">
                        <li class="list-group-item tag-1">
                            <a href="../../../../tag/security.html">
                                security
                            </a>
                        </li>
                        <li class="list-group-item tag-1">
                            <a href="../../../../tag/internet/">
                                internet
                            </a>
                        </li>
                        <li class="list-group-item tag-1">
                            <a href="../../../../tag/cyber-security/">
                                cyber security
                            </a>
                        </li>
                        <li class="list-group-item tag-1">
                            <a href="../../../../tag/online.html">
                                online
                            </a>
                        </li>
                        <li class="list-group-item tag-2">
                            <a href="../../../../tag/macedonia/">
                                macedonia
                            </a>
                        </li>
                        <li class="list-group-item tag-2">
                            <a href="../../../../tag/malware.html">
                                malware
                            </a>
                        </li>
                        <li class="list-group-item tag-2">
                            <a href="../../../../tag/network.html">
                                network
                            </a>
                        </li>
                        <li class="list-group-item tag-2">
                            <a href="../../../../tag/ddos.html">
                                DDoS
                            </a>
                        </li>
                        <li class="list-group-item tag-2">
                            <a href="../../../../tag/networking/">
                                networking
                            </a>
                        </li>
                        <li class="list-group-item tag-2">
                            <a href="../../../../tag/conference/">
                                conference
                            </a>
                        </li>
                        <li class="list-group-item tag-2">
                            <a href="../../../../tag/attacks.html">
                                attacks
                            </a>
                        </li>
                        <li class="list-group-item tag-3">
                            <a href="../../../../tag/teaching/">
                                teaching
                            </a>
                        </li>
                        <li class="list-group-item tag-3">
                            <a href="../../../../tag/testing-ids/">
                                testing ids
                            </a>
                        </li>
                        <li class="list-group-item tag-3">
                            <a href="../../../../tag/risk-assessment/">
                                risk assessment
                            </a>
                        </li>
                        <li class="list-group-item tag-3">
                            <a href="../../../../tag/awareness/">
                                awareness
                            </a>
                        </li>
                        <li class="list-group-item tag-3">
                            <a href="../../../../tag/wordpress.html">
                                wordpress
                            </a>
                        </li>
                        <li class="list-group-item tag-3">
                            <a href="../../../../tag/cyber/">
                                cyber
                            </a>
                        </li>
                        <li class="list-group-item tag-3">
                            <a href="../../../../tag/information-warfare/">
                                information warfare
                            </a>
                        </li>
                        <li class="list-group-item tag-3">
                            <a href="../../../../tag/nato/">
                                nato
                            </a>
                        </li>
                        <li class="list-group-item tag-3">
                            <a href="../../../../tag/malicious-code.html">
                                malicious code
                            </a>
                        </li>
                        <li class="list-group-item tag-3">
                            <a href="../../../../tag/ubuntu.html">
                                ubuntu
                            </a>
                        </li>
                        <li class="list-group-item tag-3">
                            <a href="../../../../tag/binary.html">
                                binary
                            </a>
                        </li>
                        <li class="list-group-item tag-3">
                            <a href="../../../../tag/pentest-mag.html">
                                pentest mag
                            </a>
                        </li>
                        <li class="list-group-item tag-3">
                            <a href="../../../../tag/network-security.html">
                                network security
                            </a>
                        </li>
                        <li class="list-group-item tag-3">
                            <a href="../../../../tag/simmulation-of-attacks-and-defence.html">
                                simmulation of attacks and defence
                            </a>
                        </li>
                        <li class="list-group-item tag-3">
                            <a href="../../../../tag/interview/">
                                interview
                            </a>
                        </li>
                        <li class="list-group-item tag-3">
                            <a href="../../../../tag/network-crime.html">
                                network crime
                            </a>
                        </li>
                        <li class="list-group-item tag-3">
                            <a href="../../../../tag/ids/">
                                ids
                            </a>
                        </li>
                        <li class="list-group-item tag-3">
                            <a href="../../../../tag/wlan.html">
                                wlan
                            </a>
                        </li>
                        <li class="list-group-item tag-3">
                            <a href="../../../../tag/port-scan/">
                                Port scan
                            </a>
                        </li>
                        <li class="list-group-item tag-3">
                            <a href="../../../../tag/gms.html">
                                gms
                            </a>
                        </li>
                        <li class="list-group-item tag-3">
                            <a href="../../../../tag/art-of-war.html">
                                art of war
                            </a>
                        </li>
                        <li class="list-group-item tag-3">
                            <a href="../../../../tag/snort/">
                                snort
                            </a>
                        </li>
                        <li class="list-group-item tag-3">
                            <a href="../../../../tag/threats.html">
                                threats
                            </a>
                        </li>
                        <li class="list-group-item tag-3">
                            <a href="../../../../tag/wpan.html">
                                wpan
                            </a>
                        </li>
                        <li class="list-group-item tag-3">
                            <a href="../../../../tag/unix.html">
                                Unix
                            </a>
                        </li>
                        <li class="list-group-item tag-3">
                            <a href="../../../../tag/syn-flood/">
                                SYN flood
                            </a>
                        </li>
                        <li class="list-group-item tag-3">
                            <a href="../../../../tag/vulnerability.html">
                                vulnerability
                            </a>
                        </li>
                        <li class="list-group-item tag-3">
                            <a href="../../../../tag/vulnerability-scanning/">
                                vulnerability scanning
                            </a>
                        </li>
                        <li class="list-group-item tag-3">
                            <a href="../../../../tag/forum/">
                                forum
                            </a>
                        </li>
                        <li class="list-group-item tag-3">
                            <a href="../../../../tag/mvr/">
                                mvr
                            </a>
                        </li>
                        <li class="list-group-item tag-3">
                            <a href="../../../../tag/risk-management/">
                                risk management
                            </a>
                        </li>
                        <li class="list-group-item tag-3">
                            <a href="../../../../tag/freedom/">
                                freedom
                            </a>
                        </li>
                        <li class="list-group-item tag-3">
                            <a href="../../../../tag/course/">
                                course
                            </a>
                        </li>
                        <li class="list-group-item tag-3">
                            <a href="../../../../tag/acceleration.html">
                                acceleration
                            </a>
                        </li>
                        <li class="list-group-item tag-3">
                            <a href="../../../../tag/wireless.html">
                                wireless
                            </a>
                        </li>
                        <li class="list-group-item tag-3">
                            <a href="../../../../tag/online-generations.html">
                                online generations
                            </a>
                        </li>
                        <li class="list-group-item tag-3">
                            <a href="../../../../tag/log-mining/">
                                log mining
                            </a>
                        </li>
                        <li class="list-group-item tag-3">
                            <a href="../../../../tag/wifi.html">
                                wifi
                            </a>
                        </li>
                        <li class="list-group-item tag-3">
                            <a href="../../../../tag/history.html">
                                history
                            </a>
                        </li>
                        <li class="list-group-item tag-3">
                            <a href="../../../../tag/digital-divide/">
                                digital divide
                            </a>
                        </li>
                        <li class="list-group-item tag-3">
                            <a href="../../../../tag/optamization.html">
                                optamization
                            </a>
                        </li>
                        <li class="list-group-item tag-3">
                            <a href="../../../../tag/balkan/">
                                balkan
                            </a>
                        </li>
                        <li class="list-group-item tag-3">
                            <a href="../../../../tag/future-of-human-communication.html">
                                future of human communication
                            </a>
                        </li>
                        <li class="list-group-item tag-4">
                            <a href="../../../../tag/malware-analysis/">
                                malware analysis
                            </a>
                        </li>
                        <li class="list-group-item tag-4">
                            <a href="../../../../tag/security-model.html">
                                security model
                            </a>
                        </li>
                        <li class="list-group-item tag-4">
                            <a href="../../../../tag/c.html">
                                C#
                            </a>
                        </li>
                        <li class="list-group-item tag-4">
                            <a href="../../../../tag/new-war.html">
                                new war
                            </a>
                        </li>
                        <li class="list-group-item tag-4">
                            <a href="../../../../tag/european-round/">
                                european round
                            </a>
                        </li>
                        <li class="list-group-item tag-4">
                            <a href="../../../../tag/penetration.html">
                                penetration
                            </a>
                        </li>
                        <li class="list-group-item tag-4">
                            <a href="../../../../tag/hack/">
                                hack
                            </a>
                        </li>
                        <li class="list-group-item tag-4">
                            <a href="../../../../tag/non-repudation.html">
                                non-repudation
                            </a>
                        </li>
                        <li class="list-group-item tag-4">
                            <a href="../../../../tag/startups/">
                                startups
                            </a>
                        </li>
                        <li class="list-group-item tag-4">
                            <a href="../../../../tag/cyber-risk/">
                                cyber risk
                            </a>
                        </li>
                        <li class="list-group-item tag-4">
                            <a href="../../../../tag/bulgaria/">
                                bulgaria
                            </a>
                        </li>
                        <li class="list-group-item tag-4">
                            <a href="../../../../tag/pentest.html">
                                pentest
                            </a>
                        </li>
                        <li class="list-group-item tag-4">
                            <a href="../../../../tag/south-eastern-europe.html">
                                south eastern europe
                            </a>
                        </li>
                        <li class="list-group-item tag-4">
                            <a href="../../../../tag/cyber-warfare.html">
                                cyber warfare
                            </a>
                        </li>
                        <li class="list-group-item tag-4">
                            <a href="../../../../tag/kaspersky/">
                                kaspersky
                            </a>
                        </li>
                        <li class="list-group-item tag-4">
                            <a href="../../../../tag/surfaj-bezbedno/">
                                surfaj bezbedno
                            </a>
                        </li>
                        <li class="list-group-item tag-4">
                            <a href="../../../../tag/wordpress-attacks.html">
                                wordpress attacks
                            </a>
                        </li>
                        <li class="list-group-item tag-4">
                            <a href="../../../../tag/brute-force.html">
                                brute force
                            </a>
                        </li>
                        <li class="list-group-item tag-4">
                            <a href="../../../../tag/internet-protocol-addressing-systems.html">
                                Internet Protocol addressing systems
                            </a>
                        </li>
                        <li class="list-group-item tag-4">
                            <a href="../../../../tag/cyber-defence/">
                                cyber defence
                            </a>
                        </li>
                        <li class="list-group-item tag-4">
                            <a href="../../../../tag/psyche.html">
                                psyche
                            </a>
                        </li>
                        <li class="list-group-item tag-4">
                            <a href="../../../../tag/laptop.html">
                                laptop
                            </a>
                        </li>
                        <li class="list-group-item tag-4">
                            <a href="../../../../tag/nework-crime.html">
                                nework crime
                            </a>
                        </li>
                        <li class="list-group-item tag-4">
                            <a href="../../../../tag/social-network/">
                                social network
                            </a>
                        </li>
                        <li class="list-group-item tag-4">
                            <a href="../../../../tag/linux.html">
                                linux
                            </a>
                        </li>
                        <li class="list-group-item tag-4">
                            <a href="../../../../tag/human-factor/">
                                human factor
                            </a>
                        </li>
                        <li class="list-group-item tag-4">
                            <a href="../../../../tag/cybersecuritymk.html">
                                cybersecurity.mk
                            </a>
                        </li>
                        <li class="list-group-item tag-4">
                            <a href="../../../../tag/program/">
                                program
                            </a>
                        </li>
                        <li class="list-group-item tag-4">
                            <a href="../../../../tag/eavesdropping.html">
                                eavesdropping
                            </a>
                        </li>
                        <li class="list-group-item tag-4">
                            <a href="../../../../tag/socio-technical/">
                                socio-technical
                            </a>
                        </li>
                        <li class="list-group-item tag-4">
                            <a href="../../../../tag/cybersecurity.html">
                                cybersecurity
                            </a>
                        </li>
                        <li class="list-group-item tag-4">
                            <a href="../../../../tag/grep.html">
                                grep
                            </a>
                        </li>
                        <li class="list-group-item tag-4">
                            <a href="../../../../tag/rainbow-tables.html">
                                rainbow tables
                            </a>
                        </li>
                        <li class="list-group-item tag-4">
                            <a href="../../../../tag/ngo.html">
                                NGO
                            </a>
                        </li>
                        <li class="list-group-item tag-4">
                            <a href="../../../../tag/script-kiddie/">
                                script kiddie
                            </a>
                        </li>
                        <li class="list-group-item tag-4">
                            <a href="../../../../tag/hci.html">
                                HCI
                            </a>
                        </li>
                        <li class="list-group-item tag-4">
                            <a href="../../../../tag/group.html">
                                group
                            </a>
                        </li>
                        <li class="list-group-item tag-4">
                            <a href="../../../../tag/phone.html">
                                phone
                            </a>
                        </li>
                        <li class="list-group-item tag-4">
                            <a href="../../../../tag/cyber-space.html">
                                cyber space
                            </a>
                        </li>
                        <li class="list-group-item tag-4">
                            <a href="../../../../tag/python.html">
                                python
                            </a>
                        </li>
                        <li class="list-group-item tag-4">
                            <a href="../../../../tag/wireshark/">
                                wireshark
                            </a>
                        </li>
                        <li class="list-group-item tag-4">
                            <a href="../../../../tag/texworks.html">
                                texworks
                            </a>
                        </li>
                        <li class="list-group-item tag-4">
                            <a href="../../../../tag/snort-rules/">
                                snort rules
                            </a>
                        </li>
                        <li class="list-group-item tag-4">
                            <a href="../../../../tag/hql.html">
                                HQL
                            </a>
                        </li>
                        <li class="list-group-item tag-4">
                            <a href="../../../../tag/war-strategy.html">
                                war strategy
                            </a>
                        </li>
                        <li class="list-group-item tag-4">
                            <a href="../../../../tag/server-attack/">
                                server attack
                            </a>
                        </li>
                    </ul>
                </li>    
    <li class="list-group-item"><h4><i class="fa fa-external-link-square fa-lg"></i><span class="icon-label">Links</span></h4>
      <ul class="list-group" id="links">
        <li class="list-group-item">
            <a href="http://getpelican.com/" target="_blank">
                Pelican
            </a>
        </li>
        <li class="list-group-item">
            <a href="http://python.org/" target="_blank">
                Python.org
            </a>
        </li>
        <li class="list-group-item">
            <a href="http://jinja.pocoo.org/" target="_blank">
                Jinja2
            </a>
        </li>
      </ul>
    </li>

        </ul>
    </section>

</aside>        </div>
    </div>
</div>
<footer>
   <div class="container">
      <hr>
      <div class="row">
         <div class="col-xs-10">&copy; 2014 Predrag TASEVSKI - Pece
            &middot; Powered by <a href="https://github.com/DandyDev/pelican-bootstrap3" target="_blank">pelican-bootstrap3</a>,
            <a href="http://docs.getpelican.com/" target="_blank">Pelican</a>,
            <a href="http://getbootstrap.com" target="_blank">Bootstrap</a>         </div>
         <div class="col-xs-2"><p class="pull-right"><i class="fa fa-arrow-up"></i> <a href="#">Back to top</a></p></div>
      </div>
   </div>
</footer>
<script src="../../../../theme/js/jquery.min.js"></script>

<!-- Include all compiled plugins (below), or include individual files as needed -->
<script src="../../../../theme/js/bootstrap.min.js"></script>

<!-- Enable responsive features in IE8 with Respond.js (https://github.com/scottjehl/Respond) -->
<script src="../../../../theme/js/respond.min.js"></script>

    <!-- Disqus -->
    <script type="text/javascript">
        /* * * CONFIGURATION VARIABLES: EDIT BEFORE PASTING INTO YOUR WEBPAGE * * */
        var disqus_shortname = 'predragtasevski.com'; // required: replace example with your forum shortname

        /* * * DON'T EDIT BELOW THIS LINE * * */
        (function () {
            var s = document.createElement('script');
            s.async = true;
            s.type = 'text/javascript';
            s.src = '//' + disqus_shortname + '.disqus.com/count.js';
            (document.getElementsByTagName('HEAD')[0] || document.getElementsByTagName('BODY')[0]).appendChild(s);
        }());
    </script>
    <!-- End Disqus Code -->
    <!-- Google Analytics -->
    <script type="text/javascript">

        var _gaq = _gaq || [];
        _gaq.push(['_setAccount', 'UA-46154062-1']);
        _gaq.push(['_trackPageview']);

        (function () {
            var ga = document.createElement('script');
            ga.type = 'text/javascript';
            ga.async = true;
            ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
            var s = document.getElementsByTagName('script')[0];
            s.parentNode.insertBefore(ga, s);
        })();
    </script>
    <!-- End Google Analytics Code -->
</body>
</html>