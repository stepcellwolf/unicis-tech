<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom"><title>Predrag TASEVSKI - Pece</title><link href="http://predragtasevski.com/" rel="alternate"></link><link href="http://predragtasevski.com/feeds/tag/wireshark.atom.xml" rel="self"></link><id>http://predragtasevski.com/</id><updated>2012-09-02T00:00:00+01:00</updated><entry><title>Identify Possible Infection of Malware Into the Wireshark Capture File</title><link href="http://predragtasevski.com/posts/2012/09/identify-possible-infection-of-malware-into-the-wireshark-capture-file/" rel="alternate"></link><updated>2012-09-02T00:00:00+01:00</updated><author><name>Predrag TASEVSKI - Pece</name></author><id>tag:predragtasevski.com,2012-09-02:posts/2012/09/identify-possible-infection-of-malware-into-the-wireshark-capture-file/</id><summary type="html">&lt;h1&gt;INTRODUCTION&lt;/h1&gt;
&lt;p&gt;The main goal of laboratory report is to identify possible infection of malware into the wireshark capture file. The report should highlight the following aspects:
- Download [not avaibale anymore]
- Find malware download in this pcap and extract malware or malwares find out where malware was downloaded from.
- What malware, malwares changes in system.
- C&amp;amp;C Names and address.
- Document the process also where You found hints and how exactly You did it (you need to show Your thought and communication process – please write a summary of it.)
- Write an incident report.&lt;/p&gt;
&lt;p&gt;Moreover, we have to consider the malware analysis report reminders, please refer to [1] or [2]. Additional, analysis it is stated into the Analysis section, where we explain the techniques, filter tools, gather knowledge, links, etc. Structure of the laboratory report is first to present analysis with details information. Malware and infections description are described. Finally the conclusion made of all analysis will be concise in summary section.&lt;/p&gt;
&lt;h1&gt;ANALYSIS&lt;/h1&gt;
&lt;p&gt;To be able to open and use the above file, firstly we have to download the wireshark tool. Where the main goal and purpose for wireshark application is to analysis a network protocols from captured file. Therefore please refer to the following link: &lt;a href="http://www.wireshark.org/" target="_blank"&gt;http://www.wireshark.org/&lt;/a&gt;.&lt;/p&gt;
&lt;p&gt;Useful links for future use, please refer to [3, 4, 5 and 6]. On figure 1 it shows the Graphic Interface of Wireshark application with running filter: http protocol.&lt;/p&gt;
&lt;iframe src="https://www.flickr.com/photos/29569957@N00/15515742317/player/" width="320" height="173" frameborder="0" allowfullscreen webkitallowfullscreen mozallowfullscreen oallowfullscreen msallowfullscreen&gt;&lt;/iframe&gt;

&lt;p&gt;Illustration 1: Wireshark application, filter: http protocol&lt;/p&gt;
&lt;p&gt;However, from the figure 1 we can see that there is a lot of traffic generated by the user. Therefore we have to apply and additional filter rules, which will help and guide for better and easy analysis. As we go through each generated http protocol traffic we can conclude that the user generated and has been visiting different source, where can be potential threat for the organization and personal use with a different malicious code.&lt;/p&gt;
&lt;p&gt;To be able to filter only the http protocols on port 80 with a header GET, we should use the following filter: http.request.method == “GET”. Where this filter will narrow down the results that are presented into the captured file. In spite of the filter above it helps a lot, yet there is still a lot of traffic generated, consequently we have to utilize an additional filter.&lt;/p&gt;
&lt;p&gt;Another extremely useful wireshark option we used, was Analyze → Follow TCP Stream which shows communication between IP addresses in more readable and useful way: shows DNS name for the IP and if file was downloaded gives filetype and name. We discovered that IP address 79.137.237.34 belongs to accord-component.ru. When we accessed the site with various web browsers, all of them showed that it contained malware.&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span class="nb"&gt;GET&lt;/span&gt; &lt;span class="p"&gt;/&lt;/span&gt;&lt;span class="nx"&gt;serial&lt;/span&gt;&lt;span class="p"&gt;/&lt;/span&gt;&lt;span class="nx"&gt;index.php&lt;/span&gt; &lt;span class="nx"&gt;HTTP&lt;/span&gt;&lt;span class="p"&gt;/&lt;/span&gt;&lt;span class="nx"&gt;1.1&lt;/span&gt;
&lt;span class="nb"&gt;Accept&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="o"&gt;*/*&lt;/span&gt;
&lt;span class="nb"&gt;Accept&lt;/span&gt;&lt;span class="na"&gt;-Encoding&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="nx"&gt;gzip&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="nx"&gt;deflate&lt;/span&gt;
&lt;span class="nb"&gt;User&lt;/span&gt;&lt;span class="na"&gt;-Agent&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="nx"&gt;Mozilla&lt;/span&gt;&lt;span class="p"&gt;/&lt;/span&gt;&lt;span class="nx"&gt;4.0&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nx"&gt;compatible&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt; &lt;span class="nx"&gt;MSIE&lt;/span&gt; &lt;span class="mf"&gt;8.0&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt; &lt;span class="nx"&gt;Windows&lt;/span&gt; &lt;span class="nx"&gt;NT&lt;/span&gt; &lt;span class="mf"&gt;6.1&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt; &lt;span class="nx"&gt;Trident&lt;/span&gt;&lt;span class="p"&gt;/&lt;/span&gt;&lt;span class="nx"&gt;4.0&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt; &lt;span class="nx"&gt;SLCC2&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt; &lt;span class="bp"&gt;.&lt;/span&gt;&lt;span class="nb"&gt;NET&lt;/span&gt;
&lt;span class="nx"&gt;CLR&lt;/span&gt; &lt;span class="mf"&gt;2.0.50727&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt; &lt;span class="bp"&gt;.&lt;/span&gt;&lt;span class="nb"&gt;NET&lt;/span&gt; &lt;span class="nx"&gt;CLR&lt;/span&gt; &lt;span class="mf"&gt;3.5.30729&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt; &lt;span class="bp"&gt;.&lt;/span&gt;&lt;span class="nb"&gt;NET&lt;/span&gt; &lt;span class="nx"&gt;CLR&lt;/span&gt; &lt;span class="mf"&gt;3.0.30729&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt; &lt;span class="nb"&gt;Media&lt;/span&gt; &lt;span class="nx"&gt;Center&lt;/span&gt; &lt;span class="nx"&gt;PC&lt;/span&gt; &lt;span class="mf"&gt;6.0&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;span class="nb"&gt;Connection&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="nx"&gt;Keep&lt;/span&gt;&lt;span class="na"&gt;-Alive&lt;/span&gt;
&lt;span class="nb"&gt;Host&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="nx"&gt;accord&lt;/span&gt;&lt;span class="na"&gt;-component.ru&lt;/span&gt;
&lt;span class="nx"&gt;HTTP&lt;/span&gt;&lt;span class="p"&gt;/&lt;/span&gt;&lt;span class="nx"&gt;1.1&lt;/span&gt; &lt;span class="mi"&gt;200&lt;/span&gt; &lt;span class="nx"&gt;OK&lt;/span&gt;
&lt;span class="nx"&gt;Server&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="nx"&gt;nginx&lt;/span&gt;
&lt;span class="kt"&gt;Date&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="nx"&gt;Wed&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;30&lt;/span&gt; &lt;span class="nx"&gt;Nov&lt;/span&gt; &lt;span class="mi"&gt;2011&lt;/span&gt; &lt;span class="mi"&gt;23&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="mi"&gt;07&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="mi"&gt;18&lt;/span&gt;
&lt;span class="nx"&gt;GMTContent&lt;/span&gt;&lt;span class="na"&gt;-Type&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="nx"&gt;text&lt;/span&gt;&lt;span class="p"&gt;/&lt;/span&gt;&lt;span class="nx"&gt;html&lt;/span&gt;
&lt;span class="nx"&gt;Transfer&lt;/span&gt;&lt;span class="na"&gt;-Encoding&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="nb"&gt;chunked&lt;/span&gt;
&lt;span class="nb"&gt;Connection&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="nx"&gt;keep&lt;/span&gt;&lt;span class="na"&gt;-alive&lt;/span&gt;
&lt;span class="nx"&gt;X&lt;/span&gt;&lt;span class="na"&gt;-Powered-By&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="nx"&gt;PHP&lt;/span&gt;&lt;span class="p"&gt;/&lt;/span&gt;&lt;span class="nx"&gt;5.3.2&lt;/span&gt;
&lt;span class="nb"&gt;Content&lt;/span&gt;&lt;span class="na"&gt;-Encoding&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="nx"&gt;gzip&lt;/span&gt;
&lt;span class="o"&gt;&amp;lt;/&lt;/span&gt;&lt;span class="nx"&gt;pre&lt;/span&gt;&lt;span class="o"&gt;&amp;gt;&lt;/span&gt;
&lt;span class="o"&gt;&amp;lt;&lt;/span&gt;&lt;span class="nx"&gt;p&lt;/span&gt;&lt;span class="o"&gt;&amp;gt;&lt;/span&gt;&lt;span class="nx"&gt;Another&lt;/span&gt; &lt;span class="nx"&gt;suspicious&lt;/span&gt; &lt;span class="nx"&gt;IP&lt;/span&gt; &lt;span class="nx"&gt;was&lt;/span&gt; &lt;span class="mf"&gt;86.63.168.101&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="k"&gt;where&lt;/span&gt; &lt;span class="nb"&gt;from&lt;/span&gt; &lt;span class="nx"&gt;this&lt;/span&gt; &lt;span class="nx"&gt;IP&lt;/span&gt; &lt;span class="nx"&gt;address&lt;/span&gt; &lt;span class="nx"&gt;brought&lt;/span&gt; &lt;span class="nx"&gt;us&lt;/span&gt; &lt;span class="k"&gt;to&lt;/span&gt;&lt;span class="o"&gt;&amp;lt;&lt;/span&gt;&lt;span class="nx"&gt;br&lt;/span&gt;&lt;span class="o"&gt;&amp;gt;&lt;/span&gt;
&lt;span class="nx"&gt;domain&lt;/span&gt; &lt;span class="nb"&gt;name&lt;/span&gt; &lt;span class="nx"&gt;zumlelao.com&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="nx"&gt;but&lt;/span&gt; &lt;span class="nx"&gt;it&lt;/span&gt; &lt;span class="nx"&gt;was&lt;/span&gt; &lt;span class="nx"&gt;un&lt;/span&gt;&lt;span class="na"&gt;-accessible&lt;/span&gt; &lt;span class="nb"&gt;from&lt;/span&gt; &lt;span class="nx"&gt;browsers.&lt;/span&gt; &lt;span class="nx"&gt;Wireshark&lt;/span&gt; &lt;span class="nx"&gt;showed&lt;/span&gt; &lt;span class="nx"&gt;the&lt;/span&gt; &lt;span class="nb"&gt;User&lt;/span&gt; &lt;span class="nx"&gt;downloaded&lt;/span&gt; &lt;span class="nb"&gt;file&lt;/span&gt; &lt;span class="mi"&gt;4&lt;/span&gt;&lt;span class="bp"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;exe&lt;/span&gt; &lt;span class="nb"&gt;from&lt;/span&gt; &lt;span class="nx"&gt;zumlelao.com.&lt;/span&gt;&lt;span class="o"&gt;&amp;lt;/&lt;/span&gt;&lt;span class="nx"&gt;p&lt;/span&gt;&lt;span class="o"&gt;&amp;gt;&lt;/span&gt;
&lt;span class="o"&gt;&amp;lt;&lt;/span&gt;&lt;span class="nx"&gt;pre&lt;/span&gt; &lt;span class="n"&gt;class&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;brush: php&amp;quot;&lt;/span&gt;&lt;span class="o"&gt;&amp;gt;&lt;/span&gt;&lt;span class="nb"&gt;GET&lt;/span&gt; &lt;span class="p"&gt;/&lt;/span&gt;&lt;span class="nx"&gt;load.php&lt;/span&gt;&lt;span class="o"&gt;?&lt;/span&gt;&lt;span class="n"&gt;file&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;
&lt;span class="nx"&gt;HTTP&lt;/span&gt;&lt;span class="p"&gt;/&lt;/span&gt;&lt;span class="nx"&gt;1.1Accept&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="nb"&gt;image&lt;/span&gt;&lt;span class="p"&gt;/&lt;/span&gt;&lt;span class="nx"&gt;jpeg&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="nx"&gt;application&lt;/span&gt;&lt;span class="p"&gt;/&lt;/span&gt;&lt;span class="nx"&gt;x&lt;/span&gt;&lt;span class="na"&gt;-ms-application&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="nb"&gt;image&lt;/span&gt;&lt;span class="p"&gt;/&lt;/span&gt;&lt;span class="nx"&gt;gif&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
&lt;span class="nx"&gt;application&lt;/span&gt;&lt;span class="p"&gt;/&lt;/span&gt;&lt;span class="nx"&gt;xaml&lt;/span&gt;&lt;span class="o"&gt;+&lt;/span&gt;&lt;span class="kt"&gt;xml&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="nb"&gt;image&lt;/span&gt;&lt;span class="p"&gt;/&lt;/span&gt;&lt;span class="nx"&gt;pjpeg&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="nx"&gt;application&lt;/span&gt;&lt;span class="p"&gt;/&lt;/span&gt;&lt;span class="nx"&gt;x&lt;/span&gt;&lt;span class="na"&gt;-ms-xbap&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="o"&gt;*/*&lt;/span&gt;
&lt;span class="nb"&gt;Accept&lt;/span&gt;&lt;span class="na"&gt;-Language&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="nx"&gt;et&lt;/span&gt;
&lt;span class="nb"&gt;User&lt;/span&gt;&lt;span class="na"&gt;-Agent&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="nx"&gt;Mozilla&lt;/span&gt;&lt;span class="p"&gt;/&lt;/span&gt;&lt;span class="nx"&gt;4.0&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nx"&gt;compatible&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt; &lt;span class="nx"&gt;MSIE&lt;/span&gt; &lt;span class="mf"&gt;8.0&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt; &lt;span class="nx"&gt;Windows&lt;/span&gt; &lt;span class="nx"&gt;NT&lt;/span&gt; &lt;span class="mf"&gt;6.1&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt; &lt;span class="nx"&gt;Trident&lt;/span&gt;&lt;span class="p"&gt;/&lt;/span&gt;&lt;span class="nx"&gt;4.0&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt; &lt;span class="nx"&gt;SLCC2&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt; &lt;span class="bp"&gt;.&lt;/span&gt;&lt;span class="nb"&gt;NET&lt;/span&gt;
&lt;span class="nx"&gt;CLR&lt;/span&gt; &lt;span class="mf"&gt;2.0.50727&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt; &lt;span class="bp"&gt;.&lt;/span&gt;&lt;span class="nb"&gt;NET&lt;/span&gt; &lt;span class="nx"&gt;CLR&lt;/span&gt; &lt;span class="mf"&gt;3.5.30729&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt; &lt;span class="bp"&gt;.&lt;/span&gt;&lt;span class="nb"&gt;NET&lt;/span&gt; &lt;span class="nx"&gt;CLR&lt;/span&gt; &lt;span class="mf"&gt;3.0.30729&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt; &lt;span class="nb"&gt;Media&lt;/span&gt; &lt;span class="nx"&gt;Center&lt;/span&gt; &lt;span class="nx"&gt;PC&lt;/span&gt; &lt;span class="mf"&gt;6.0&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;span class="nb"&gt;Accept&lt;/span&gt;&lt;span class="na"&gt;-Encoding&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="nx"&gt;gzip&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="nx"&gt;deflate&lt;/span&gt;
&lt;span class="nb"&gt;Host&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="nx"&gt;zumlelao.com&lt;/span&gt;
&lt;span class="nb"&gt;Connection&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="nx"&gt;Keep&lt;/span&gt;&lt;span class="na"&gt;-AliveHTTP&lt;/span&gt;&lt;span class="p"&gt;/&lt;/span&gt;&lt;span class="nx"&gt;1.1&lt;/span&gt; &lt;span class="mi"&gt;200&lt;/span&gt; &lt;span class="nx"&gt;OK&lt;/span&gt;
&lt;span class="kt"&gt;Date&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="nx"&gt;Wed&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;30&lt;/span&gt; &lt;span class="nx"&gt;Nov&lt;/span&gt; &lt;span class="mi"&gt;2011&lt;/span&gt; &lt;span class="mi"&gt;21&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="mi"&gt;55&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="mi"&gt;02&lt;/span&gt;
&lt;span class="nx"&gt;GMTServer&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="nx"&gt;Apache&lt;/span&gt;&lt;span class="p"&gt;/&lt;/span&gt;&lt;span class="nx"&gt;2&lt;/span&gt;
&lt;span class="nx"&gt;X&lt;/span&gt;&lt;span class="na"&gt;-Powered-By&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="nx"&gt;PHP&lt;/span&gt;&lt;span class="p"&gt;/&lt;/span&gt;&lt;span class="nx"&gt;5.2.17&lt;/span&gt;
&lt;span class="k"&gt;Cache&lt;/span&gt;&lt;span class="na"&gt;-Control&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="k"&gt;public&lt;/span&gt;
&lt;span class="nf"&gt;Content&lt;/span&gt;&lt;span class="na"&gt;-Disposition&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="nx"&gt;attachment&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt; &lt;span class="n"&gt;filename&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="mi"&gt;4&lt;/span&gt;&lt;span class="bp"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;exe&lt;/span&gt;
&lt;span class="nb"&gt;Content&lt;/span&gt;&lt;span class="na"&gt;-Transfer-Encoding&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="nx"&gt;binary&lt;/span&gt;
&lt;span class="nx"&gt;Vary&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="nb"&gt;Accept&lt;/span&gt;&lt;span class="na"&gt;-Encoding&lt;/span&gt;
&lt;span class="nb"&gt;Content&lt;/span&gt;&lt;span class="na"&gt;-Encoding&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="nx"&gt;gzip&lt;/span&gt;
&lt;span class="nb"&gt;Content&lt;/span&gt;&lt;span class="na"&gt;-Length&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="mi"&gt;10666&lt;/span&gt;
&lt;span class="nx"&gt;Keep&lt;/span&gt;&lt;span class="na"&gt;-Alive&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="n"&gt;timeout&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="k"&gt;max&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="mi"&gt;100&lt;/span&gt;
&lt;span class="nb"&gt;Connection&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="nx"&gt;Keep&lt;/span&gt;&lt;span class="na"&gt;-Alive&lt;/span&gt;
&lt;span class="nb"&gt;Content&lt;/span&gt;&lt;span class="na"&gt;-Type&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="nx"&gt;application&lt;/span&gt;&lt;span class="p"&gt;/&lt;/span&gt;&lt;span class="nx"&gt;octet&lt;/span&gt;&lt;span class="na"&gt;-stream&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;Additionally, we can always use an Find function, which will help as to identify certain traffic or site. Figure 2 demonstrated the usage of the Find function, accessible from menu Edit -&amp;gt; Find.&lt;/p&gt;
&lt;iframe src="https://www.flickr.com/photos/29569957@N00/15515544178/in/photostream/player/" width="320" height="177" frameborder="0" allowfullscreen webkitallowfullscreen mozallowfullscreen oallowfullscreen msallowfullscreen&gt;&lt;/iframe&gt;

&lt;p&gt;Illustration 2: Wireshark, Find function&lt;/p&gt;
&lt;p&gt;Other IP addresses that were generated/extracted first the ones with malware detected: &lt;code&gt;79.137.237.34 -accord-component.ru; 86.63.168.101 zumlelao.com&lt;/code&gt;. Other IP’s are: &lt;code&gt;173.194.32.32 (33,34,41,50,51,52,58,59,60,63), 192.168.123.1, 193.184.164.159 (174,176,185), 193.40.252.83, 193.88.71.156, 194.126.108.69 (70), 194.126.124.136, 194.204.14.49, 195.222.15.74, 199.7.48.190, 209.85.173.95, 123.168.24.204 (209,221,225,229,235), 79.137.237.34, 80.252.91.41 (61), 69.171.228.11, 23.32.89.55, 23.32.99.172, 216.34.181.45 (48), 213.168.24.26, 90.190.148.34 (40), 86.63.168.101, 82.98.58.48, 81.19.238.61.&lt;/code&gt;&lt;/p&gt;
&lt;p&gt;If we run or analysis the above domain names into the google we will automatic indicated that the zumlelao.com it is an before reported as a malware site and the second too. Therefore the analysis and the infection of details of malware are highlighted into the next section.&lt;/p&gt;
&lt;h1&gt;INFECTION&lt;/h1&gt;
&lt;p&gt;Indeed, the above captured file presents traffic generated by the user, that can be threat for the organization, home user, etc. As from the previous section demonstrates how to identify if the generated traffic has infected or has the user visit the malicious code sites. This section identifies the malicious code and displays their details. Moreover, the zumlelao.com host it is reported previous as malicious code site. For this purpose we gather the help from the following link: &lt;a href="http://sopport.clean-mx.de/" target="_blank"&gt;http://sopport.clean-mx.de/&lt;/a&gt;. Here is the reported malicious, suspicious code from the above host in the table bellow.&lt;/p&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th align="right"&gt;URL&lt;/th&gt;
&lt;th align="center"&gt;Virus name&lt;/th&gt;
&lt;th align="center"&gt;IP Initial&lt;/th&gt;
&lt;th align="right"&gt;Link&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td align="right"&gt;http://zumlelao.com/oad.php?file=grabbers&lt;/td&gt;
&lt;td align="center"&gt;0/40(0.0%) unknown_htm&lt;/td&gt;
&lt;td align="center"&gt;86.63.168.101&lt;/td&gt;
&lt;td align="right"&gt;&lt;a href="http://support.clean-mx.de/clean-mx/viruses?id=1108452" target="_blank"&gt;http://support.clean-mx.de/clean-mx/viruses?id=1108452&lt;/a&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td align="right"&gt;http://zumlelao.com/2.exe&lt;/td&gt;
&lt;td align="center"&gt;13/40 (32.5%) TR/TDss.77.1&lt;/td&gt;
&lt;td align="center"&gt;86.63.168.101&lt;/td&gt;
&lt;td align="right"&gt;&lt;a href="http://support.clean-mx.de/clean-mx/viruses?id=1108438" target="_blank"&gt;http://support.clean-mx.de/clean-mx/viruses?id=1108438&lt;/a&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td align="right"&gt;http://zumlelao.com/load.php?file=0&lt;/td&gt;
&lt;td align="center"&gt;20/40 (50%) TR/Crypt.XPACK.Gen3&lt;/td&gt;
&lt;td align="center"&gt;86.63.168.101&lt;/td&gt;
&lt;td align="right"&gt;&lt;a href="http://support.clean-mx.de/clean-mx/viruses?id=1108442" target="_blank"&gt;http://support.clean-mx.de/clean-mx/viruses?id=1108442&lt;/a&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;p&gt;Furthermore, figure 3 is proving the analysis made through the wireshark, were one of the above links has been access, for more details clink on the above link and points in a figure 3:A and B.&lt;/p&gt;
&lt;iframe src="https://www.flickr.com/photos/29569957@N00/15677213166/in/photostream/player/" width="320" height="173" frameborder="0" allowfullscreen webkitallowfullscreen mozallowfullscreen oallowfullscreen msallowfullscreen&gt;&lt;/iframe&gt;

&lt;p&gt;Illustration 3: Prove of generating traffic of following malware link: http://zumlelao.com/load.php?file=0 were B and A are proving the links and the IP initiation.&lt;/p&gt;
&lt;p&gt;Moreover, to get the file itself for analysis, we used Netresec’s Network Miner 2.1 http://www.netresec.com/?page=NetworkMiner. In Files menu, it shows all packets as files.We uploaded 4.exe.octet-stream to virustotal.com – 30 Antivirus software identified as malware Virustotal link: &lt;a href="http://www.virustotal.com/file-scan/report.html?id=d6ee8736cd2eae8571b193b28b59dff33e9607237f78b0888d69c70f241bb04b-%201323098398" target="_blank"&gt;http://www.virustotal.com/file-scan/report.html?id=d6ee8736cd2eae8571b193b28b59dff33e9607237f78b0888d69c70f241bb04b-1323098398&lt;/a&gt;&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span class="n"&gt;MD5&lt;/span&gt; &lt;span class="o"&gt;:&lt;/span&gt; &lt;span class="mi"&gt;94&lt;/span&gt;&lt;span class="n"&gt;a7f6430510fe7314c1e746bad79bf4&lt;/span&gt;
&lt;span class="n"&gt;SHA1&lt;/span&gt; &lt;span class="o"&gt;:&lt;/span&gt; &lt;span class="mi"&gt;69&lt;/span&gt;&lt;span class="n"&gt;ab04c9c586a8cf07a00665e160a48260a2465e&lt;/span&gt;
&lt;span class="n"&gt;SHA256&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt; &lt;span class="n"&gt;d6ee8736cd2eae8571b193b28b59dff33e9607237f78b0888d69c70f241bb04b&lt;/span&gt;
&lt;span class="n"&gt;F&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="n"&gt;Secure&lt;/span&gt; &lt;span class="n"&gt;identified&lt;/span&gt; &lt;span class="n"&gt;malware&lt;/span&gt; &lt;span class="k"&gt;as&lt;/span&gt; &lt;span class="n"&gt;Trojan&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="na"&gt;Generic&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="na"&gt;KD&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="mi"&gt;438472&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;Trojan.Generic.KD malwares usually are classified as Backdoors. It infects executable files in the system and its main goal is to make backdoor into the system. It changes registry. In some cases it can put payload on the infected system, slow it down and make internet browsing difficult and time consuming. Aim of the malware can be stealing information or gaining partial/full access of the victim’s system. On the other hand, Trojan.Generic.KD malwares are difficult to remove from infected computers. From VirusTotal analysis we can see that various antivirus software can discover and identify Trojan.Generic.KD.438472. Therefore one can remove malware by downloading antivirus software provided by F-Secure, Comodo, Microsoft, Sophos, Symantec, DrWeb, etc. Here is an example from Dr.Web how to delete Trojan.Generic.KD malware &lt;a href="http://www.drwebhk.com/en/virus_removal/694829/Trojan.Generic.KD.53986.html" target="_blank"&gt;http://www.drwebhk.com/en/virus_removal/694829/Trojan.Generic.KD.53986.html&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;For our case we downloaded Dr.Web CureIt (free edition for home PCs, which discovered the malware and removed it) – &lt;a href="http://www.freedrweb.com/download+cureit/?nc=t&amp;amp;lng=en" target="_blank"&gt;http://www.freedrweb.com/download+cureit/?nc=t&amp;amp;lng=en&lt;/a&gt;.&lt;/p&gt;
&lt;p&gt;Before continuing to disinfect the system, please read and understand the massage delivered through this forum: &lt;a href="http://forums.majorgeeks.com/showthread.php?t=35407"  target="_blank"&gt;http://forums.majorgeeks.com/showthread.php?t=35407&lt;/a&gt;.&lt;/p&gt;
&lt;h1&gt;SUMMARY&lt;/h1&gt;
&lt;p&gt;Nowadays malicious codes, infection of the system is one of the highest vector of production work everyday of the organizations. Therefore, different approaches, advance analysis, troubleshooting, etc. has to be applicable and stated in every organization. Leaking of data, information, access of network (internal and external) can be very harmful for organization and even the home usage of computers. Therefore, this laboratory report main aim is to provide the reader to be able to conduct advance analysis of system and their identification of infection within the wireshark network analysis tool.&lt;/p&gt;
&lt;p&gt;From the above sections in Analysis and in the Infection we have to follow the steps and links that will help us for a further work. Meanwhile, the captured generated traffic from the distributed file has indeed indicated that the system it is infected. Were as an prove we demonstrate an screen-shot, figure 3, that one of the infected link has been visited. Likewise, the system of this user is infected. Thus infection identified name is: TR/Crypt.XPACK.Gen3, where we do supply and the disinfecting stepwise solution with the above link. Closing, as there are many different ways, tools, process for analysing the malicious code behaviours in system this laboratory report is supplying the reader with advance and stepwise solution for identifying the infection of the system within advance network analysis wireshark application.&lt;/p&gt;
&lt;h1&gt;WORKLOAD&lt;/h1&gt;
&lt;p&gt;We made analysis on the virtual Windows 7 machine. For virtualization we used VirtualBox. During analysis each of group member did the same analysis to cross - reference the results.&lt;/p&gt;
&lt;p&gt;We basically used the following tools: Wireshark, Network Miner and &lt;a href="http://virustotal.com/"  target="_blank"&gt;virustotal.com&lt;/a&gt;.&lt;/p&gt;
&lt;h1&gt;Bibliography&lt;/h1&gt;
&lt;p&gt;[1] Lenny Zeltser, Reverse-Engineering: Malware Analysis Tools and Techniques Training, 2011, &lt;a href="http://zeltser.com/reverse-malware/" target="_blank"&gt;http://zeltser.com/reverse-malware/&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;[2] Lenny Zeltser, Malware analysis report reminders, 2011, &lt;a href="http://zeltser.com/reverse-%20malware/malware-analysis-report-template.mm" target="_blank"&gt;http://zeltser.com/reverse-malware/malware-analysis-report-template.mm&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;[3] Kevin, Malware Analysis &amp;amp; Malware Reverse Engineering, NA, &lt;a href="http://technology-flow.com/articles/windows-malware-analysis/" target="_blank"&gt;http://technology-flow.com/articles/windows-malware-analysis/&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;[4] Chris Greer, Top 10 Wireshark Filters, April 2010, &lt;a href="http://www.lovemytool.com/blog/2010/04/top-10-wireshark-filters-by-chris-greer.html" target="_blank"&gt;http://www.lovemytool.com/blog/2010/04/top-10-wireshark-filters-by-chris-greer.html&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;[5] Russ McRe, Security Analysis with Wireshar, November 2006&lt;/p&gt;
&lt;p&gt;[6] Chief Banana, Using Wireshark filters for capturing malware, Marh 2011, &lt;a href="http://securitybananas.com/?p=529" target="_blank"&gt;http://securitybananas.com/?p=529&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;The above post is written by Predrag Tasevski and Mikheil Basilaia&lt;/p&gt;</summary><category term="capture file"></category><category term="cyber security"></category><category term="infection"></category><category term="malware"></category><category term="networking"></category><category term="online"></category><category term="wireshark"></category></entry></feed>