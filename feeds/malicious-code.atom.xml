<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom"><title>Predrag TASEVSKI - Pece - malicious code</title><link href="http://predragtasevski.com/" rel="alternate"></link><link href="http://predragtasevski.com/feeds/malicious-code.atom.xml" rel="self"></link><id>http://predragtasevski.com/</id><updated>2012-09-30T23:00:00+02:00</updated><entry><title>Analyses of Malware Files</title><link href="http://predragtasevski.com/posts/2012/09/analyses-of-malware-files/" rel="alternate"></link><published>2012-09-30T23:00:00+02:00</published><updated>2012-09-30T23:00:00+02:00</updated><author><name>Predrag TASEVSKI - Pece</name></author><id>tag:predragtasevski.com,2012-09-30:/posts/2012/09/analyses-of-malware-files/</id><summary type="html">&lt;h1&gt;PURPOSE&lt;/h1&gt;
&lt;/p&gt;

&lt;p&gt;The main goal of laboratory report is to identify three analyses of
malware files from the archive file send by the lecture. The archive
contains 89 malware files. The way how we choice 3 files is by following
algorithm:&lt;/p&gt;
&lt;/p&gt;

&lt;ol&gt;
&lt;li&gt;Soft them by name&lt;/li&gt;
&lt;li&gt;First use last number of your …&lt;/li&gt;&lt;/ol&gt;</summary><content type="html">&lt;h1&gt;PURPOSE&lt;/h1&gt;
&lt;/p&gt;

&lt;p&gt;The main goal of laboratory report is to identify three analyses of
malware files from the archive file send by the lecture. The archive
contains 89 malware files. The way how we choice 3 files is by following
algorithm:&lt;/p&gt;
&lt;/p&gt;

&lt;ol&gt;
&lt;li&gt;Soft them by name&lt;/li&gt;
&lt;li&gt;First use last number of your student code + your birthday day&lt;/li&gt;
&lt;li&gt;Second, generate random number from &lt;a href="http://www.random.org/"&gt;http://www.random.org/&lt;/a&gt; and
    only if it does not match first number use it for choosing the file&lt;/li&gt;
&lt;li&gt;Third, use random number generator again and if it does not match
    first or second number use it.&lt;/li&gt;
&lt;/ol&gt;
&lt;/p&gt;

&lt;p&gt;Malware archive can be download from the following link: [unfortunatly
not available anymore]&lt;/p&gt;
&lt;/p&gt;

&lt;p&gt;&lt;em&gt;WARNING FILE CONTAINS LIVE VIRUSES&lt;/em&gt;&lt;/p&gt;
&lt;/p&gt;

&lt;p&gt;Task that need to be complete for this laboratory assignment:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;Pick your malware&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;Run your malware against 2 of next online analysis tools&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;a href="http://www.virustotal.com/"&gt;http://www.virustotal.com/&lt;/a&gt;&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;a href="http://camas.comodo.com/"&gt;http://camas.comodo.com/&lt;/a&gt;&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;a href="http://www.threatexpert.com/submit.aspx"&gt;http://www.threatexpert.com/submit.aspx&lt;/a&gt;&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;Find additional 2 online analysis tools where to analyse virus.&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;Things that should be presented in the laboratory report are:&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;Chosen numbers&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;General information about malware&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;name&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;md5&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;sha1&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;link to analysis result if it is possible&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;link to disinfecting instructions – if not possible explanation why it
is not&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;Analysis tools – links&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;Your opinion about each analysis tool and comparison results.&lt;/p&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;/p&gt;

&lt;p&gt;Firstly, we are going to analyse the chosen files in section Chosen
files and each file with the above required information and detail
analysis results, links to disinfecting instructions, analysis tools
used for this purpose. Secondary, expression about each analysis tool
used and comparison results will be presented in section Analysis. In
addition, in section Appendixes its provides what virtual environment
has been used for this laboratory report. Because we know that if we
open this file in our real machine we will get infected. That is why we
are using an Linux virtual environment.&lt;/p&gt;
&lt;/p&gt;

&lt;p&gt;Furthermore, each file will be analysed with two different tools, in
case to gather more information and solution for disinfecting process.
Finally the conclusion made of all collected data will be concise in
conclusion section.&lt;/p&gt;
&lt;/p&gt;

&lt;h1&gt;CHOSEN FILES&lt;/h1&gt;
&lt;/p&gt;

&lt;p&gt;Number of files are listed bellow and the name of the file that is going
to be analysed:&lt;/p&gt;
&lt;p&gt;​1. Number: 71; File name: &lt;code&gt;sales.exe; Size: 454.7 KB&lt;/code&gt;&lt;/p&gt;
&lt;p&gt;​2. Number: 57; File name: &lt;code&gt;mgre.exe; Size: 61.4 KB&lt;/code&gt;&lt;/p&gt;
&lt;p&gt;​3. Number: 60; File name: &lt;code&gt;moos3.ee; Size: 91.6 KB&lt;/code&gt;&lt;/p&gt;
&lt;/p&gt;

&lt;h2&gt;FILE 1&lt;/h2&gt;
&lt;/p&gt;

&lt;p&gt;File name: &lt;code&gt;sales.exe; Size: 454.7 KB;&lt;/code&gt; Number: 71.&lt;/p&gt;
&lt;/p&gt;

&lt;div class="highlight"&gt;

    MD5: 093e72cbc78b46e977561c5874cfab4cSHA1 Hash: e79a730b01b6689c336138f39c79fbd2ea45b6c1SSDeep Hash: 12288:2Pqr7eKhHvZ3NSYqHMsD+vgp0pQe1lhJ:283vhN1qHMsD+Ip8QEz

&lt;/div&gt;

&lt;/p&gt;

&lt;p&gt;Links to analyse report:&lt;/p&gt;
&lt;/p&gt;

&lt;ol&gt;
&lt;li&gt;&lt;a href="http://www.netscty.com/report/690/e12093ea-3ae7-4fac-a%20218-5721b1aabded-347"&gt;http://www.netscty.com/report/690/e12093ea-3ae7-4fac-a
    218-5721b1aabded-347&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href="http://www.virustotal.com/file-scan/report.html?%20id=6f47a1f72fa005900f40803ede1a2a55167e641011271b49543eef748ffcb5a1-%201318408947#"&gt;http://www.virustotal.com/file-scan/report.html?id=6f47a1f72fa005900f40803ede1a2a55167e641011271b49543eef748ffcb5a1-1318408947#&lt;/a&gt;&lt;/li&gt;
&lt;/ol&gt;
&lt;/p&gt;

&lt;p&gt;The above malware file has been reported that is capable to send out
e-mail message with the built in SMTP client engine. Second, it contains
characteristics of Waledac, a worm that spreads by sending an e-mail
containing links to copies of itself. And finally, creates a startup
registry entry.&lt;/p&gt;
&lt;/p&gt;

&lt;p&gt;Links provided, are demonstrating which anti virus software/application
can disinfected the malware infection.&lt;/p&gt;
&lt;/p&gt;

&lt;p&gt;Tools for analysing the malware are:&lt;/p&gt;
&lt;p&gt;​1. Netscty – Online Sandbox: &lt;a href="http://netscty.com/malware-tool"&gt;http://netscty.com/malware-tool&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;​2. Virustotal.com – &lt;a href="http://www.virustotal.com/index.html"&gt;http://www.virustotal.com/index.html&lt;/a&gt;&lt;/p&gt;
&lt;/p&gt;

&lt;h2&gt;FILE 2&lt;/h2&gt;
&lt;/p&gt;

&lt;p&gt;File name: &lt;code&gt;mgre.exe; Size: 61.4 KB;&lt;/code&gt; Number: 57.&lt;/p&gt;
&lt;/p&gt;

&lt;div class="highlight"&gt;

    MD5: 1375a8e437db6acafe2b0419cfbff7ecSHA1:b48f702a5a0fa8558c278dd97ecfbd0d637fefd3SHA256: 89294d70e80547aac5b506915d2e8fc0309c0e578ab16fc9875c9a4668e63709

&lt;/div&gt;

&lt;/p&gt;

&lt;p&gt;Links to analyse report:&lt;/p&gt;
&lt;p&gt;​1.
&lt;a href="http://camas.comodo.com/cgi-bin/submit?%20file=89294d70e80547aac5b506915d2e8fc0309c0e578ab16fc9875c9a4668e63709"&gt;http://camas.comodo.com/cgi-bin/submit?file=89294d70e80547aac5b506915d2e8fc0309c0e578ab16fc9875c9a4668e63709&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;​2.
&lt;a href="http://wepawet.iseclab.org/view.php?%20hash=1375a8e437db6acafe2b0419cfbff7ec&amp;amp;type=js"&gt;http://wepawet.iseclab.org/view.php?hash=1375a8e437db6acafe2b0419cfbff7ec&amp;amp;type=js&lt;/a&gt;&lt;/p&gt;
&lt;/p&gt;

&lt;p&gt;From above analysed links we can conclude that the file creates keys, it
changes values in registry, it change only one file, creates process
called sample.exe and adds value to the modules.&lt;/p&gt;
&lt;/p&gt;

&lt;p&gt;The links do not show any way of disinfecting the following malware
file. My personal opinion of the above links is good that they can show
you that this file is malware, but still they do not show you enough
information. Which can help you for further instructions and actions
that should be consider. Not even providing you an information or links
which anti virus software can help you.&lt;/p&gt;
&lt;/p&gt;

&lt;p&gt;Tools for analysing the malware are:&lt;/p&gt;
&lt;/p&gt;

&lt;ol&gt;
&lt;li&gt;Comodo Instant Malware Analysis – &lt;a href="http://camas.comodo.com/"&gt;http://camas.comodo.com/&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;Wepawe – &lt;a href="http://wepawet.iseclab.org/"&gt;http://wepawet.iseclab.org/&lt;/a&gt;&lt;/li&gt;
&lt;/ol&gt;
&lt;/p&gt;

&lt;h2&gt;FILE 3&lt;/h2&gt;
&lt;/p&gt;

&lt;p&gt;File name: &lt;code&gt;moos3.exe; Size: 91.6 KB;&lt;/code&gt; Number: 60.&lt;/p&gt;
&lt;/p&gt;

&lt;div class="highlight"&gt;

    MD5: 4ddade6548142d5fd5b742f34b71e1daSHA-1: 5345bdd52591b0fcd8e9a81fed7a7b588e24a15d

&lt;/div&gt;

&lt;/p&gt;

&lt;p&gt;Links to analyse report:&lt;/p&gt;
&lt;p&gt;​1.
&lt;a href="http://anubis.iseclab.org/?%20action=result&amp;amp;task_id=13e22805d763a08d4d158904eae5e709d&amp;amp;format=html"&gt;http://anubis.iseclab.org/?action=result&amp;amp;task_id=13e22805d763a08d4d158904eae5e709d&amp;amp;format=html&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;​2.
&lt;a href="http://www.threatexpert.com/report.aspx?%20md5=4ddade6548142d5fd5b742f34b71e1da"&gt;http://www.threatexpert.com/report.aspx?md5=4ddade6548142d5fd5b742f34b71e1da&lt;/a&gt;&lt;/p&gt;
&lt;/p&gt;

&lt;p&gt;The malware file, contains characteristics of an identified security
risk. Possible security risk is Backdoor.Agent.AJU [Backdoor.Agent.AJU].
The threat category is network-aware worm and malicious trojan horse.
Its modifying file system, memory and registry. The origin of this
malware indicates possible country, Russian Federation.&lt;/p&gt;
&lt;/p&gt;

&lt;p&gt;From the reports we can conclude that most of the known anti virus
software has hit of this malware infection and it can disinfected.&lt;/p&gt;
&lt;/p&gt;

&lt;p&gt;Tools for analysing the malware are:&lt;/p&gt;
&lt;p&gt;​1. Anubis: Analyzing Unknown Binaries – &lt;a href="http://anubis.iseclab.org/"&gt;http://anubis.iseclab.org/&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;​2. ThreatExpert – &lt;a href="http://www.threatexpert.com/"&gt;http://www.threatexpert.com/&lt;/a&gt;&lt;/p&gt;
&lt;/p&gt;

&lt;h1&gt;ANALYSIS&lt;/h1&gt;
&lt;/p&gt;

&lt;p&gt;The web tool that we have used to analysis three of random chosen files
are listed bellow.&lt;/p&gt;
&lt;/p&gt;

&lt;p&gt;Moreover, we will compare each one of those service, what kind of
information they show, provide and do they supply with disinfected
solution, if so how, and why not.&lt;/p&gt;
&lt;/p&gt;

&lt;ol&gt;
&lt;li&gt;Netscty – Online Sandbox: &lt;a href="http://netscty.com/malware-tool"&gt;http://netscty.com/malware-tool&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;Virustotal.com – &lt;a href="http://www.virustotal.com/index.html"&gt;http://www.virustotal.com/index.html&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;Comodo Instant Malware Analysis – &lt;a href="http://camas.comodo.com/"&gt;http://camas.comodo.com/&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;Wepawe – &lt;a href="http://wepawet.iseclab.org/"&gt;http://wepawet.iseclab.org/&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;Anubis: Analyzing Unknown Binaries – &lt;a href="http://anubis.iseclab.org/"&gt;http://anubis.iseclab.org/&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;ThreatExpert – &lt;a href="http://www.threatexpert.com/"&gt;http://www.threatexpert.com/&lt;/a&gt;&lt;/li&gt;
&lt;/ol&gt;
&lt;/p&gt;

&lt;p&gt;To compare our results from the above list of online analysing tools I
have setup an score from 1 to 5 of each section. Where the highest score
is better solution. With the following attributes:&lt;/p&gt;
&lt;/p&gt;

&lt;table&gt;
&lt;/p&gt;
&lt;p&gt;
&lt;thead&gt;
&lt;/p&gt;
&lt;p&gt;
&lt;tr&gt;
&lt;/p&gt;
&lt;p&gt;
&lt;th align="right"&gt;
Easy to use

&lt;/th&gt;
&lt;/p&gt;
&lt;p&gt;
&lt;th align="center"&gt;
Provides enough information

&lt;/th&gt;
&lt;/p&gt;
&lt;p&gt;
&lt;th align="center"&gt;
Disinfected information

&lt;/th&gt;
&lt;/p&gt;
&lt;p&gt;
&lt;th align="right"&gt;
TOTAL

&lt;/th&gt;
&lt;/p&gt;
&lt;p&gt;
&lt;/tr&gt;
&lt;/p&gt;
&lt;p&gt;
&lt;/thead&gt;
&lt;/p&gt;
&lt;p&gt;
&lt;tbody&gt;
&lt;/p&gt;
&lt;p&gt;
&lt;tr&gt;
&lt;/p&gt;
&lt;p&gt;
&lt;td align="right"&gt;
Netscty

&lt;/td&gt;
&lt;/p&gt;
&lt;p&gt;
&lt;td align="center"&gt;
4

&lt;/td&gt;
&lt;/p&gt;
&lt;p&gt;
&lt;td align="center"&gt;
5

&lt;/td&gt;
&lt;/p&gt;
&lt;p&gt;
&lt;td align="right"&gt;
4

&lt;/td&gt;
&lt;/p&gt;
&lt;p&gt;
&lt;/tr&gt;
&lt;/p&gt;
&lt;p&gt;
&lt;tr&gt;
&lt;/p&gt;
&lt;p&gt;
&lt;td align="right"&gt;
Virustotal.com

&lt;/td&gt;
&lt;/p&gt;
&lt;p&gt;
&lt;td align="center"&gt;
5

&lt;/td&gt;
&lt;/p&gt;
&lt;p&gt;
&lt;td align="center"&gt;
4

&lt;/td&gt;
&lt;/p&gt;
&lt;p&gt;
&lt;td align="right"&gt;
5

&lt;/td&gt;
&lt;/p&gt;
&lt;p&gt;
&lt;/tr&gt;
&lt;/p&gt;
&lt;p&gt;
&lt;tr&gt;
&lt;/p&gt;
&lt;p&gt;
&lt;td align="right"&gt;
Comodo

&lt;/td&gt;
&lt;/p&gt;
&lt;p&gt;
&lt;td align="center"&gt;
5

&lt;/td&gt;
&lt;/p&gt;
&lt;p&gt;
&lt;td align="center"&gt;
3

&lt;/td&gt;
&lt;/p&gt;
&lt;p&gt;
&lt;td align="right"&gt;
2

&lt;/td&gt;
&lt;/p&gt;
&lt;p&gt;
&lt;/tr&gt;
&lt;/p&gt;
&lt;p&gt;
&lt;tr&gt;
&lt;/p&gt;
&lt;p&gt;
&lt;td align="right"&gt;
Wepawe

&lt;/td&gt;
&lt;/p&gt;
&lt;p&gt;
&lt;td align="center"&gt;
4

&lt;/td&gt;
&lt;/p&gt;
&lt;p&gt;
&lt;td align="center"&gt;
1

&lt;/td&gt;
&lt;/p&gt;
&lt;p&gt;
&lt;td align="right"&gt;
1

&lt;/td&gt;
&lt;/p&gt;
&lt;p&gt;
&lt;/tr&gt;
&lt;/p&gt;
&lt;p&gt;
&lt;tr&gt;
&lt;/p&gt;
&lt;p&gt;
&lt;td align="right"&gt;
Anubis

&lt;/td&gt;
&lt;/p&gt;
&lt;p&gt;
&lt;td align="center"&gt;
5

&lt;/td&gt;
&lt;/p&gt;
&lt;p&gt;
&lt;td align="center"&gt;
3

&lt;/td&gt;
&lt;/p&gt;
&lt;p&gt;
&lt;td align="right"&gt;
1

&lt;/td&gt;
&lt;/p&gt;
&lt;p&gt;
&lt;/tr&gt;
&lt;/p&gt;
&lt;p&gt;
&lt;tr&gt;
&lt;/p&gt;
&lt;p&gt;
&lt;td align="right"&gt;
ThreatExpert

&lt;/td&gt;
&lt;/p&gt;
&lt;p&gt;
&lt;td align="center"&gt;
5

&lt;/td&gt;
&lt;/p&gt;
&lt;p&gt;
&lt;td align="center"&gt;
5

&lt;/td&gt;
&lt;/p&gt;
&lt;p&gt;
&lt;td align="right"&gt;
5

&lt;/td&gt;
&lt;/p&gt;
&lt;p&gt;
&lt;/tr&gt;
&lt;/p&gt;
&lt;p&gt;
&lt;/tbody&gt;
&lt;/p&gt;
&lt;p&gt;
&lt;/table&gt;

&lt;/p&gt;

&lt;p&gt;The above table give as an perfect over view, which tool is easy to use,
provides enough information, disinfected information and gain the
highest mark.&lt;/p&gt;
&lt;/p&gt;

&lt;h1&gt;CONCLUSION&lt;/h1&gt;
&lt;/p&gt;

&lt;p&gt;I would like to generalize that from the above information we see that
each online analysing tool has own means, criteria and different
information to distribute. On the whole, some of them were not that easy
and simple to use, yet they provide as with expectant information and
disinfected solutions. Therefore, our succeeder for this test
is ThreatExpert. But bear in mind that I have not measure and compare
all the online tool-kits for analysing the files, just the ones listed
in the previous section. For furthermore, please refer to the following
article that was publish in 2010 by Lenny Zeltser
[MalwareAnalysisToolkit].&lt;/p&gt;
&lt;/p&gt;

&lt;p&gt;In summary, we found out that the chosen files are malware. Likewise,
can harm our computer in different methods. Yet we got an information
for some, for instance how to disinfected the computer. Therefore, we
made a comparison table to scale the best online analysing tool for
malware. Where total number is 6 tools, and different score rank. The
first one is TheratExpert, secondly is Virustotal.com and the third is
Netscty. Still all of mentioned tools score difference with one point.&lt;/p&gt;
&lt;/p&gt;

&lt;h1&gt;APPENDIXES&lt;/h1&gt;
&lt;/p&gt;

&lt;p&gt;Appendix 1 is configuration of the virtual environment.&lt;/p&gt;
&lt;/p&gt;

&lt;h2&gt;APPENDIX 1&lt;/h2&gt;
&lt;/p&gt;

&lt;div class="highlight"&gt;

    Virtual environment: Oracle VirtualBox Version 4.1.2 r73507. Downloadable from the following link: https://www.virtualbox.org/wiki/DownloadsSecurity Fedora 14 32 bit – Client: http://spins.fedoraproject.org/security/• Base Memory: 512 MB• Acceleration: VT-x/AMD-V, Nested Paging• Display – Video memory: 12 MB• Storage: SATA Controller, Port 0: 8 GB• Network:◦ Adapter 1: Adapter 1: Parvirtualized Network (NAT)◦ Adapter 2: Adapter 2: Inter PRO/1000 MT Desktop (Host-only adapter, VirtualBox Host- Only Enternet Adapter)

&lt;/div&gt;

&lt;/p&gt;

&lt;h1&gt;Bibliography&lt;/h1&gt;
&lt;/p&gt;

&lt;p&gt;Backdoor.Agent.AJU: ThreatExpert, ThreatExpert’s Statistics for
Backdoor.Agent.AJU [PC Tools], 2011,
&lt;a href="http://www.threatexpert.com/threats/backdoor-agent-aju.html"&gt;http://www.threatexpert.com/threats/backdoor-agent-aju.html&lt;/a&gt;&lt;/p&gt;
&lt;/p&gt;

&lt;p&gt;MalwareAnalysisToolkit: Lenny Zeltser, 5 Steps to Building a Malware
Analysis Toolkit Using Free Tools, January 2010,
&lt;a href="http://zeltser.com/malware-analysis-toolkit/"&gt;http://zeltser.com/malware-analysis-toolkit/&lt;/a&gt;&lt;/p&gt;
&lt;/p&gt;</content><category term="malware"></category><category term="online"></category><category term="security"></category><category term="binary"></category><category term="malicious code"></category></entry><entry><title>Clever solution by making site more resilient by optimization</title><link href="http://predragtasevski.com/posts/2012/03/clever-solution-by-making-site-more-resilient-by-optimization/" rel="alternate"></link><published>2012-03-23T00:00:00+01:00</published><updated>2012-03-23T00:00:00+01:00</updated><author><name>Predrag TASEVSKI - Pece</name></author><id>tag:predragtasevski.com,2012-03-23:/posts/2012/03/clever-solution-by-making-site-more-resilient-by-optimization/</id><summary type="html">&lt;h1&gt;PURPOSE &amp;amp; SCENARIO&lt;/h1&gt;
&lt;/p&gt;

&lt;p&gt;The objective of this laboratory test, scenario is to make explore
alternative “clever” solutions (as opposed to making the site more
resilient by optimizing it) to protect your site against attacks.
Moreover, DDoS [1] attacks, malicious code, etc.&lt;/p&gt;
&lt;/p&gt;

&lt;p&gt;Therefore, we need to develop countermeasures for the &lt;strong&gt;working&lt;/strong&gt;
attacks …&lt;/p&gt;</summary><content type="html">&lt;h1&gt;PURPOSE &amp;amp; SCENARIO&lt;/h1&gt;
&lt;/p&gt;

&lt;p&gt;The objective of this laboratory test, scenario is to make explore
alternative “clever” solutions (as opposed to making the site more
resilient by optimizing it) to protect your site against attacks.
Moreover, DDoS [1] attacks, malicious code, etc.&lt;/p&gt;
&lt;/p&gt;

&lt;p&gt;Therefore, we need to develop countermeasures for the &lt;strong&gt;working&lt;/strong&gt;
attacks simulated with a standard DoS attack from a single IP address
(performed with AB [2] or Jmeter). Limitations for this scenarios is
highlighted:&lt;/p&gt;
&lt;/p&gt;

&lt;ul&gt;
&lt;li&gt;No additional hardware can be used&lt;/li&gt;
&lt;li&gt;The wordpress installation can not be optimized: no caching plugins,
    no reverse-proxy (varnish, squid etc)&lt;/li&gt;
&lt;li&gt;No reactive measures that automatically block incoming traffic: the
    site must respond to at least some of the requests coming from the
    attacker at all times&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;The countermeasures must not have negative effects on “normal usage
    pattern”. Normal usage pattern is defined as:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;Bursts of 10 connections per IP address in 1 second&lt;/li&gt;
&lt;li&gt;Page load times not over 10 seconds&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;&lt;/p&gt;
&lt;p&gt;
-   Normal usage must be possible from the same IP address that the
attack originated from after a 20 second delay maximum.&lt;/p&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;/p&gt;

&lt;p&gt;In addition, we have to make much of the rules for the scenario. Rules
as follow: Fresh installation of the latest version of Ubuntu Server and
the most recent WordPress as of 20.10.2011. First priority: No normal
usage pattern connections can be dropped! Second priority: service speed
of normal connections. Defined by number of connections / second (easy
to measure). Third priority: How fast after the attack is stopped, the
site can be accessed from the attacking IP again.&lt;/p&gt;
&lt;/p&gt;

&lt;p&gt;Each test and measured results will be exposed in to Test section.
Whereas, the process of installation of clever solution and attacking
scripts will be provided in to Appendixes section.&lt;/p&gt;
&lt;/p&gt;

&lt;p&gt;Finally, the measurement results will be compared with the first state
without attack and any security solutions applied. Alternatively,
providing measurement results with one solution and attack will help us
to identify the most beneficial security solution. Therefore, in
Conclusion section comparison results will be highlighted.&lt;/p&gt;
&lt;/p&gt;

&lt;h1&gt;TESTS&lt;/h1&gt;
&lt;/p&gt;

&lt;p&gt;Because of requirements of our scenario we need to display the results
before security solution is applied and attacker performance. For this
purpose we are going to use an AB script to display the response time of
the server:&lt;/p&gt;
&lt;/p&gt;

&lt;p&gt;&lt;code&gt;ab -t 10 -n 10 -c 10 http://192.168.56.102/wordpress/&lt;/code&gt;&lt;/p&gt;
&lt;/p&gt;

&lt;p&gt;The above script provides detail information, yet only important is
Request per second. Thus, with an fresh installation and without any
security solution, it provided with result of 3.95 [#/sec]. With other
word, 3.95 number of request per second. After applying different
security solution and performing an attack to the server, results will
be divers.&lt;/p&gt;
&lt;/p&gt;

&lt;p&gt;In addition, test were done by two different virtual environment
machines. One is for testing results and the other one is to perform
attack with the following script:&lt;/p&gt;
&lt;/p&gt;

&lt;p&gt;&lt;code&gt;ab -n 100 -c 10 http://192.168.56.102/wordpress/&lt;/code&gt;&lt;/p&gt;
&lt;/p&gt;

&lt;h2&gt;TEST 1&lt;/h2&gt;
&lt;/p&gt;

&lt;p&gt;First test is to install libapache2-mod-evasive
[libapache2-mod-evasive]. Where, mod_evasive is an evasive maneuvers
module for Apache is to provide some protection in the event of an HTTP
DoS or DDoS attack or brute force attack. It is also designed to be a
detection tool, and can be easily configured to talk to ipchains,
firewalls, routers, and etcetera.&lt;/p&gt;
&lt;/p&gt;

&lt;p&gt;The process of installation and configuration refer to the Appendix 1.&lt;/p&gt;
&lt;/p&gt;

&lt;p&gt;After completed the installation and configuration process it is time to
test the security solution and to highlight the results. Before
performing the attack the results were somehow, lower then, before
installing the mod-evasive, 2.06 number request per second. When we
start the attack and in same time analysis the server responded with
timeout. The conclusion is that mod-evasive it is not enough solution.&lt;/p&gt;
&lt;/p&gt;

&lt;h2&gt;TEST 2&lt;/h2&gt;
&lt;/p&gt;

&lt;p&gt;From previous test we can see that the solution was not enough clever
for our needs. The server somehow was dead. However, we are going to
install now &lt;code&gt;mod_security&lt;/code&gt; module for apache, with side of previous
test. For more detail information of installation process and
configuration refer to Appendix 2 or to the following source
[mod_security].&lt;/p&gt;
&lt;/p&gt;

&lt;h1&gt;CONCLUSION&lt;/h1&gt;
&lt;/p&gt;

&lt;p&gt;There are three points that we should consider and to see which proposal
was more accurate and it did the job that was required in the scenario.&lt;/p&gt;
&lt;/p&gt;

&lt;p&gt;In conclusion, the above proposals are nice and good example to have an
view of how and with what tools we should perform script kiddie
techniques. How to shutdown access to a server. On the whole, it show as
how to use tools and methods of measuring the bandwidth of network and
how to limit the transfer in comfortable way.&lt;/p&gt;
&lt;/p&gt;

&lt;h1&gt;APPENDIXES&lt;/h1&gt;
&lt;/p&gt;

&lt;p&gt;Appendix 1 is connected with the Method 1, which highlighted points are
illustration on what information we should check, to clarify that the
virtual environment has limitation of the network interface. Where
Appendix 2 is for installation process of Ubuntu Server 10.04 LTS and
wordpress, mysql installation.&lt;/p&gt;
&lt;/p&gt;

&lt;h2&gt;APPENDIX 1&lt;/h2&gt;
&lt;/p&gt;

&lt;p&gt;Installation process:&lt;/p&gt;
&lt;p&gt;&lt;code&gt;sudo apt-get install libapache2-mod-evasive&lt;/code&gt;&lt;/p&gt;
&lt;p&gt;Configuration process is followed and gather from the following source
[Evasive Module], for addition proposal please refer to[Blacklist]:&lt;/p&gt;
&lt;/p&gt;

&lt;div class="highlight"&gt;

    sudo mkdir /var/log/apache2/mod_evasivesudo chown www-data /var/log/apache2/mod_evasive

&lt;/div&gt;

&lt;/p&gt;

&lt;p&gt;Afterwards, create its configuration file with a default content, with
the following command:&lt;/p&gt;
&lt;/p&gt;

&lt;div class="highlight"&gt;

    sudo nano /etc/apache2/apache2.conf IfModule mod_evasive20.c;DOSHashTableSize 3097DOSPageCount 2DOSSiteCount 50DOSPageInterval 1DOSSiteInterval 1DOSBlockingPeriod 10DOSLogDir /var/log/apache2/mod_evasiveDOSEmailNotify root@localhostDOSWhitelist 127.0.0.1DOSSystemCommand &amp;amp;quot;/sbin/iptables -I INPUT -p tcp --dport 80 -s %s -j DROP/IfModule;

&lt;/div&gt;

&lt;/p&gt;

&lt;p&gt;The above changes to take effect please restart the apache service by:&lt;/p&gt;
&lt;/p&gt;

&lt;p&gt;&lt;code&gt;sudo service apache2 restart&lt;/code&gt;&lt;/p&gt;
&lt;/p&gt;

&lt;p&gt;You can test whether it works using a script included in the deb
package:&lt;/p&gt;
&lt;/p&gt;

&lt;p&gt;&lt;code&gt;perl /usr/share/doc/libapache2-mod-evasive/examples/test.pl&lt;/code&gt;&lt;/p&gt;
&lt;/p&gt;

&lt;h2&gt;APPENDIX 2&lt;/h2&gt;
&lt;/p&gt;

&lt;p&gt;Installation and configuration of mod_security:&lt;/p&gt;
&lt;/p&gt;

&lt;p&gt;&lt;code&gt;apt-get install libapache2-modsecurity /etc/init.d/apache2 force-reload&lt;/code&gt;&lt;/p&gt;
&lt;/p&gt;

&lt;ul&gt;
&lt;li&gt;Installation media: Ubuntu 11.10 32bit iso image;&lt;/li&gt;
&lt;li&gt;HW: Virtualbox, 1CPU 32bit, 512MB RAM, 8GB HD (dynamic allocation);&lt;/li&gt;
&lt;li&gt;NIC1 NAT;&lt;/li&gt;
&lt;li&gt;NIC2 host only (for ssh and http access from host);&lt;/li&gt;
&lt;li&gt;Language used in installation process: English and country Estonia;&lt;/li&gt;
&lt;li&gt;Keyboard Layout English;&lt;/li&gt;
&lt;li&gt;no http proxy&lt;/li&gt;
&lt;li&gt;Default applications&lt;/li&gt;
&lt;li&gt;&lt;code&gt;sudo apt-get install lamp phpmyadmin&lt;/code&gt;&lt;/li&gt;
&lt;li&gt;&lt;code&gt;wget -c http://wordpress.org/latest.tar.gz&lt;/code&gt;&lt;/li&gt;
&lt;li&gt;&lt;code&gt;tar xvjf latest.tar.gz&lt;/code&gt;&lt;/li&gt;
&lt;li&gt;&lt;code&gt;sudo cp wordpress /var/www/wordpress&lt;/code&gt;&lt;/li&gt;
&lt;li&gt;&lt;code&gt;sudo nano /var/www/wordpress/wp-config.php&lt;/code&gt;&lt;/li&gt;
&lt;li&gt;Change the settings to your needs&lt;/li&gt;
&lt;/ul&gt;
&lt;/p&gt;

&lt;h1&gt;Bibliography&lt;/h1&gt;
&lt;/p&gt;

&lt;p&gt;[libapache2-mod-evasive] Canonical Ltd., Package: libapache2-mod-evasive
(1.10.1-1), 2011,
&lt;a href="http://packages.ubuntu.com/hardy/libapache2-mod-evasive"&gt;http://packages.ubuntu.com/hardy/libapache2-mod-evasive&lt;/a&gt;&lt;/p&gt;
&lt;/p&gt;

&lt;p&gt;[modsecurity] How to Forge, Secure Your Apache With mod_security, 2006,
&lt;a href="http://www.howtoforge.com/apache_mod_security"&gt;http://www.howtoforge.com/apache_mod_security&lt;/a&gt;&lt;/p&gt;
&lt;/p&gt;

&lt;p&gt;[Evasive Module] Deep Logic, Inc., Apache Evasive Maneuvers Module,
2005,
&lt;a href="http://fossies.org/unix/www/apache_httpd_modules/mod_evasive_1.10.1.tar.gz:t/mod_evasive/README"&gt;http://fossies.org/unix/www/apache_httpd_modules/mod_evasive_1.10.1.tar.gz:t/mod_evasive/README&lt;/a&gt;&lt;/p&gt;
&lt;/p&gt;

&lt;p&gt;[Blacklist] Jeff Starr, Eight Ways to Blacklist with Apache’s
mod_rewrite, Feb 2009,
&lt;a href="http://perishablepress.com/press/2009/02/03/eight-ways-to-blacklist-with-apaches-mod_rewrite/"&gt;http://perishablepress.com/press/2009/02/03/eight-ways-to-blacklist-with-apaches-mod_rewrite/&lt;/a&gt;&lt;/p&gt;
&lt;/p&gt;

&lt;h1&gt;Footnotes&lt;/h1&gt;
&lt;/p&gt;

&lt;p&gt;[1] DDoS – Denial-of-service attack&lt;/p&gt;
&lt;/p&gt;

&lt;p&gt;[2] AB - &lt;a href="http://httpd.apache.org/docs/2.0/programs/ab.html"&gt;http://httpd.apache.org/docs/2.0/programs/ab.html&lt;/a&gt;&lt;/p&gt;
&lt;/p&gt;</content><category term="ab"></category><category term="attacks"></category><category term="clever solution"></category><category term="cyber security"></category><category term="DDoS"></category><category term="internet"></category><category term="jmeter"></category><category term="malicious code"></category><category term="wordpress"></category></entry></feed>