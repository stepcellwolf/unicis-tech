<!doctype html>
<html lang="">	
<head>
	<meta charset="utf-8"/>
	<title>Analyses of Malware Files - Predrag TASEVSKI - Pece</title>	
	<meta name="author" content="Predrag TASEVSKI - Pece">
	

	<meta name="description" content="PURPOSE The main goal of laboratory report is to identify three analyses of malware files from the archive file send by the lecture. The archive contains 89 malware files. The way how we choice 3 files is by following algorithm: Soft them by name First use last number of your ...">


	<link rel="top" href="#" /><link href='http://fonts.googleapis.com/css?family=Source+Sans+Pro:300,400,600,300italic,400italic,600italic|Source+Code+Pro' rel='stylesheet' type='text/css'></link>
	<link rel="stylesheet" href="../../../../theme/css/main.css" type="text/css" />
		

</head>
	
<body>

    <div class="container">
	  
	  <header role="banner">
	    <div class="feeds">
	    </div>
	      <nav class="pages">
			  <a href="../../../../pages/about-cv.html">About (CV)</a>
-			  <a href="../../../../pages/publications.html">Publications</a>
	      </nav>
		<a href="../../../.." class="title">Predrag TASEVSKI - Pece</a>
      </header>
	
	  <div class="wrapper">

		  <div role="main" class="content">
	<article class="full">
			
		<h1>Analyses of Malware Files</h1>
		
<div class="metadata">
  <time datetime="2012-10-01T00:00:00" pubdate>lun. 01 octobre 2012</time>
    <address class="vcard author">
      by <a class="url fn" href="../../../../author/predrag-tasevski-pece.html">Predrag TASEVSKI - Pece</a>
    </address>
  in <a href="../../../../category/malware.html">malware</a>
<p class="tags">tagged <a href="../../../../tag/malware.html">malware</a>, <a href="../../../../tag/online.html">online</a>, <a href="../../../../tag/security.html">security</a>, <a href="../../../../tag/binary.html">binary</a>, <a href="../../../../tag/security.html">security</a>, <a href="../../../../tag/malicious-code.html">malicious code</a></p></div>		
		<h1>PURPOSE</h1>
<p>The main goal of laboratory report is to identify three analyses of malware files from the archive file send by the lecture. The archive contains 89 malware files. The way how we choice 3 files is by following algorithm:</p>
<ol>
<li>Soft them by name</li>
<li>First use last number of your student code + your birthday day</li>
<li>Second, generate random number from <a href="http://www.random.org/" target="_blank">http://www.random.org/</a> and only if it does not match first number use it for choosing the file</li>
<li>Third, use random number generator again and if it does not match first or second number use it.</li>
</ol>
<p>Malware archive can be download from the following link: [unfortunatly not available anymore]</p>
<p><em>WARNING FILE CONTAINS LIVE VIRUSES</em></p>
<p>Task that need to be complete for this laboratory assignment:
- Pick your malware
- Run your malware against 2 of next online analysis tools
  - <a href="http://www.virustotal.com/" target="_blank">http://www.virustotal.com/</a>
  - <a href="http://camas.comodo.com/" target="_blank">http://camas.comodo.com/</a>
  - <a href="http://www.threatexpert.com/submit.aspx" target="_blank"> http://www.threatexpert.com/submit.aspx</a>
- Find additional 2 online analysis tools where to analyse virus.
- Things that should be presented in the laboratory report are:
  - Chosen numbers
  - General information about malware
  - name
  - md5
  - sha1
  - link to analysis result if it is possible
  - link to disinfecting instructions – if not possible explanation why it is not 
- Analysis tools – links
- Your opinion about each analysis tool and comparison results.</p>
<p>Firstly, we are going to analyse the chosen files in section Chosen files and each file with the above required information and detail analysis results, links to disinfecting instructions, analysis tools used for this purpose. Secondary, expression about each analysis tool used and comparison results will be presented in section Analysis. In addition, in section Appendixes its provides what virtual environment has been used for this laboratory report. Because we know that if we open this file in our real machine we will get infected. That is why we are using an Linux virtual environment.</p>
<p>Furthermore, each file will be analysed with two different tools, in case to gather more information and solution for disinfecting process. Finally the conclusion made of all collected data will be concise in conclusion section.</p>
<h1>CHOSEN FILES</h1>
<p>Number of files are listed bellow and the name of the file that is going to be analysed:
1. Number: 71; File name: <code>sales.exe; Size: 454.7 KB</code>
2. Number: 57; File name: <code>mgre.exe; Size: 61.4 KB</code>
3. Number: 60; File name: <code>moos3.ee; Size: 91.6 KB</code></p>
<h2>FILE 1</h2>
<p>File name: <code>sales.exe; Size: 454.7 KB;</code> Number: 71.</p>
<div class="highlight"><pre><span class="n">MD5</span><span class="o">:</span> <span class="mi">093</span><span class="n">e72cbc78b46e977561c5874cfab4c</span>
<span class="n">SHA1</span> <span class="n">Hash</span><span class="o">:</span> <span class="n">e79a730b01b6689c336138f39c79fbd2ea45b6c1</span>
<span class="n">SSDeep</span> <span class="n">Hash</span><span class="o">:</span> <span class="mi">12288</span><span class="o">:</span><span class="mi">2</span><span class="n">Pqr7eKhHvZ3NSYqHMsD</span><span class="o">+</span><span class="n">vgp0pQe1lhJ</span><span class="o">:</span><span class="mi">283</span><span class="n">vhN1qHMsD</span><span class="o">+</span><span class="n">Ip8QEz</span>
</pre></div>


<p>Links to analyse report:</p>
<ol>
<li><a href="http://www.netscty.com/report/690/e12093ea-3ae7-4fac-a%20218-5721b1aabded-347" target="_blank">http://www.netscty.com/report/690/e12093ea-3ae7-4fac-a 218-5721b1aabded-347</a></li>
<li><a href="http://www.virustotal.com/file-scan/report.html?%20id=6f47a1f72fa005900f40803ede1a2a55167e641011271b49543eef748ffcb5a1-%201318408947#" target="_blank">http://www.virustotal.com/file-scan/report.html?id=6f47a1f72fa005900f40803ede1a2a55167e641011271b49543eef748ffcb5a1-1318408947#</a></li>
</ol>
<p>The above malware file has been reported that is capable to send out e-mail message with the built in SMTP client engine. Second, it contains characteristics of Waledac, a worm that spreads by sending an e-mail containing links to copies of itself. And&nbsp;finally, creates a startup registry entry.</p>
<p>Links provided, are demonstrating which anti virus software/application can disinfected the malware infection.</p>
<p>Tools for analysing the malware are:
1. Netscty – Online Sandbox: <a href="http://netscty.com/malware-tool" target="_blank">http://netscty.com/malware-tool</a>
2. Virustotal.com – <a href="http://www.virustotal.com/index.html" target="_blank">http://www.virustotal.com/index.html</a></p>
<h2>FILE 2</h2>
<p>File name: <code>mgre.exe; Size: 61.4 KB;</code> Number: 57.</p>
<div class="highlight"><pre><span class="n">MD5</span><span class="o">:</span> <span class="mi">1375</span><span class="n">a8e437db6acafe2b0419cfbff7ec</span>
<span class="n">SHA1</span><span class="o">:</span><span class="n">b48f702a5a0fa8558c278dd97ecfbd0d637fefd3</span>
<span class="n">SHA256</span><span class="o">:</span> <span class="mi">89294</span><span class="n">d70e80547aac5b506915d2e8fc0309c0e578ab16fc9875c9a4668e63709</span>
</pre></div>


<p>Links to analyse report:
1. <a href="http://camas.comodo.com/cgi-bin/submit?%20file=89294d70e80547aac5b506915d2e8fc0309c0e578ab16fc9875c9a4668e63709" target="_blank">http://camas.comodo.com/cgi-bin/submit?file=89294d70e80547aac5b506915d2e8fc0309c0e578ab16fc9875c9a4668e63709</a>
2. <a href="http://wepawet.iseclab.org/view.php?%20hash=1375a8e437db6acafe2b0419cfbff7ec&amp;type=js" target="_blank">http://wepawet.iseclab.org/view.php?hash=1375a8e437db6acafe2b0419cfbff7ec&amp;type=js</a></p>
<p>From above analysed links we can conclude that the file creates keys, it changes values in registry, it change only one file, creates process called sample.exe and adds value to the modules.</p>
<p>The links do not show any way of disinfecting the following malware file. My personal opinion of the above links is good that they can show you that this file is malware, but still they do not show you enough information. Which can help you for further instructions and actions that should be consider. Not even providing you an information or links which anti virus software can help you.</p>
<p>Tools for analysing the malware are:</p>
<ol>
<li>Comodo Instant Malware Analysis – <a href="http://camas.comodo.com/" target="_blank">http://camas.comodo.com/</a></li>
<li>Wepawe – <a href="http://wepawet.iseclab.org/" target="_blank">http://wepawet.iseclab.org/</a></li>
</ol>
<h2>FILE 3</h2>
<p>File name: <code>moos3.exe; Size: 91.6 KB;</code> Number: 60.</p>
<div class="highlight"><pre><span class="n">MD5</span><span class="o">:</span> <span class="mi">4</span><span class="n">ddade6548142d5fd5b742f34b71e1da</span>
<span class="n">SHA</span><span class="o">-</span><span class="mi">1</span><span class="o">:</span> <span class="mi">5345</span><span class="n">bdd52591b0fcd8e9a81fed7a7b588e24a15d</span>
</pre></div>


<p>Links to analyse report:
1. <a href="http://anubis.iseclab.org/?%20action=result&amp;task_id=13e22805d763a08d4d158904eae5e709d&amp;format=html" target="_blank">http://anubis.iseclab.org/?action=result&amp;task_id=13e22805d763a08d4d158904eae5e709d&amp;format=html</a>
2. <a href="http://www.threatexpert.com/report.aspx?%20md5=4ddade6548142d5fd5b742f34b71e1da" target="_blank">http://www.threatexpert.com/report.aspx?md5=4ddade6548142d5fd5b742f34b71e1da</a></p>
<p>The malware file, contains characteristics of an identified security risk. Possible security risk is Backdoor.Agent.AJU [Backdoor.Agent.AJU]. The threat category is network-aware worm and malicious trojan horse. Its modifying file system, memory and registry. The origin of this malware indicates possible country, Russian Federation.</p>
<p>From the reports we can conclude that most of the known anti virus software has hit of this malware infection and it can disinfected.</p>
<p>Tools for analysing the malware are:
1. Anubis: Analyzing Unknown Binaries – <a href="http://anubis.iseclab.org/" target="_blank">http://anubis.iseclab.org/</a>
2. ThreatExpert – <a href="http://www.threatexpert.com/" target="_blank">http://www.threatexpert.com/</a></p>
<h1>ANALYSIS</h1>
<p>The web tool that we have used to analysis three of random chosen files are listed bellow.</p>
<p>Moreover, we will compare each one of those service, what kind of information they show, provide and do they supply with disinfected solution, if so how, and why not.</p>
<ol>
<li>Netscty – Online Sandbox: <a href="http://netscty.com/malware-tool" target="_blank">http://netscty.com/malware-tool</a></li>
<li>Virustotal.com – <a href="http://www.virustotal.com/index.html"  target="_blank">http://www.virustotal.com/index.html</a></li>
<li>Comodo Instant Malware Analysis – <a href="http://camas.comodo.com/"  target="_blank">http://camas.comodo.com/</a></li>
<li>Wepawe – <a href="http://wepawet.iseclab.org/"  target="_blank">http://wepawet.iseclab.org/</a></li>
<li>Anubis: Analyzing Unknown Binaries – <a href="http://anubis.iseclab.org/" target="_blank">http://anubis.iseclab.org/</a></li>
<li>ThreatExpert – <a href="http://www.threatexpert.com/" target="_blank">http://www.threatexpert.com/</a></li>
</ol>
<p>To compare our results from the above list of online analysing tools I have setup an score from 1 to 5 of each section. Where the highest score is better solution. With the following attributes:</p>
<table>
<thead>
<tr>
<th align="right">Easy to use</th>
<th align="center">Provides enough information</th>
<th align="center">Disinfected information</th>
<th align="right">TOTAL</th>
</tr>
</thead>
<tbody>
<tr>
<td align="right">Netscty</td>
<td align="center">4</td>
<td align="center">5</td>
<td align="right">4</td>
</tr>
<tr>
<td align="right">Virustotal.com</td>
<td align="center">5</td>
<td align="center">4</td>
<td align="right">5</td>
</tr>
<tr>
<td align="right">Comodo</td>
<td align="center">5</td>
<td align="center">3</td>
<td align="right">2</td>
</tr>
<tr>
<td align="right">Wepawe</td>
<td align="center">4</td>
<td align="center">1</td>
<td align="right">1</td>
</tr>
<tr>
<td align="right">Anubis</td>
<td align="center">5</td>
<td align="center">3</td>
<td align="right">1</td>
</tr>
<tr>
<td align="right">ThreatExpert</td>
<td align="center">5</td>
<td align="center">5</td>
<td align="right">5</td>
</tr>
</tbody>
</table>
<p>The above table give as an perfect over view, which tool is easy to use, provides enough information, disinfected information and gain the highest mark.</p>
<h1>CONCLUSION</h1>
<p>I would like to generalize that from the above information we see that each online analysing tool has own means, criteria and different information to distribute. On the whole, some of them were not that easy and simple to use, yet they provide as with&nbsp;expectant information and disinfected solutions. Therefore, our succeeder for this test is&nbsp;ThreatExpert. But bear in mind that I have not measure and compare all the online tool-kits&nbsp;for analysing the files, just the ones listed in the previous section. For furthermore, please&nbsp;refer to the following article that was publish in 2010 by Lenny Zeltser [MalwareAnalysisToolkit].</p>
<p>In summary, we found out that the chosen files are malware. Likewise, can harm our computer in different methods. Yet we got an information for some, for instance how to disinfected the computer. Therefore, we made a comparison table to scale the best online analysing tool for malware. Where total number is 6 tools, and different score rank. The first one is TheratExpert, secondly is Virustotal.com and the third is Netscty. Still all of mentioned tools score difference with one point.</p>
<h1>APPENDIXES</h1>
<p>Appendix 1 is configuration of the virtual environment.</p>
<h2>APPENDIX 1</h2>
<div class="highlight"><pre><span class="n">Virtual</span> <span class="n">environment</span><span class="o">:</span> <span class="n">Oracle</span> <span class="n">VirtualBox</span> <span class="n">Version</span> <span class="mf">4.1.2</span> <span class="n">r73507</span><span class="p">.</span> <span class="n">Downloadable</span> <span class="n">from</span> <span class="n">the</span> <span class="n">following</span> <span class="n">link</span><span class="o">:</span> <span class="n">https</span><span class="o">:</span><span class="c1">//www.virtualbox.org/wiki/Downloads</span>
<span class="n">Security</span> <span class="n">Fedora</span> <span class="mi">14</span> <span class="mi">32</span> <span class="n">bit</span> <span class="err">–</span> <span class="n">Client</span><span class="o">:</span> <span class="n">http</span><span class="o">:</span><span class="c1">//spins.fedoraproject.org/security/</span>
<span class="err">•</span> <span class="n">Base</span> <span class="n">Memory</span><span class="o">:</span> <span class="mi">512</span> <span class="n">MB</span>
<span class="err">•</span> <span class="n">Acceleration</span><span class="o">:</span> <span class="n">VT</span><span class="o">-</span><span class="n">x</span><span class="o">/</span><span class="n">AMD</span><span class="o">-</span><span class="n">V</span><span class="p">,</span> <span class="n">Nested</span> <span class="n">Paging</span>
<span class="err">•</span> <span class="n">Display</span> <span class="err">–</span> <span class="n">Video</span> <span class="n">memory</span><span class="o">:</span> <span class="mi">12</span> <span class="n">MB</span>
<span class="err">•</span> <span class="n">Storage</span><span class="o">:</span> <span class="n">SATA</span> <span class="n">Controller</span><span class="p">,</span> <span class="n">Port</span> <span class="mi">0</span><span class="o">:</span> <span class="mi">8</span> <span class="n">GB</span>
<span class="err">•</span> <span class="n">Network</span><span class="o">:</span>
<span class="err">◦</span> <span class="n">Adapter</span> <span class="mi">1</span><span class="o">:</span> <span class="n">Adapter</span> <span class="mi">1</span><span class="o">:</span> <span class="n">Parvirtualized</span> <span class="n">Network</span> <span class="p">(</span><span class="n">NAT</span><span class="p">)</span>
<span class="err">◦</span> <span class="n">Adapter</span> <span class="mi">2</span><span class="o">:</span> <span class="n">Adapter</span> <span class="mi">2</span><span class="o">:</span> <span class="n">Inter</span> <span class="n">PRO</span><span class="o">/</span><span class="mi">1000</span> <span class="n">MT</span> <span class="n">Desktop</span> <span class="p">(</span><span class="n">Host</span><span class="o">-</span><span class="n">only</span> <span class="n">adapter</span><span class="p">,</span> <span class="n">VirtualBox</span> <span class="n">Host</span><span class="o">-</span> <span class="n">Only</span> <span class="n">Enternet</span> <span class="n">Adapter</span><span class="p">)</span>
</pre></div>


<h1>Bibliography</h1>
<p>Backdoor.Agent.AJU: ThreatExpert, ThreatExpert’s Statistics for Backdoor.Agent.AJU [PC Tools],&nbsp;2011, <a href="http://www.threatexpert.com/threats/backdoor-agent-aju.html" target="_blank">http://www.threatexpert.com/threats/backdoor-agent-aju.html</a></p>
<p>MalwareAnalysisToolkit: Lenny Zeltser, 5 Steps to Building a Malware Analysis Toolkit Using Free&nbsp;Tools, January 2010, <a href="http://zeltser.com/malware-analysis-toolkit/" target="_blank">http://zeltser.com/malware-analysis-toolkit/</a></p>	

	</article>

    <p>
	<a href="https://twitter.com/share" class="twitter-share-button" data-via="" data-lang="en" data-size="large" data-related="">Tweet</a>
	<script>!function(d,s,id){var js,fjs=d.getElementsByTagName(s)[0];if(!d.getElementById(id)){js=d.createElement(s);js.id=id;js.src="//platform.twitter.com/widgets.js";fjs.parentNode.insertBefore(js,fjs);}}(document,"script","twitter-wjs");</script>
	</p>


		  </div>	
		  
		  <div class="sidebar">

	        <nav>
	          <h2>Categories</h2>
	          <ul>
	              <li ><a href="../../../../category/awareness.html">awareness</a></li>
	              <li ><a href="../../../../category/camp.html">camp</a></li>
	              <li ><a href="../../../../category/collectivistic.html">collectivistic</a></li>
	              <li ><a href="../../../../category/company.html">company</a></li>
	              <li ><a href="../../../../category/conference.html">conference</a></li>
	              <li ><a href="../../../../category/cyber-crime.html">cyber crime</a></li>
	              <li ><a href="../../../../category/cyber-security.html">cyber security</a></li>
	              <li ><a href="../../../../category/cyberwar.html">cyberwar</a></li>
	              <li ><a href="../../../../category/cyberwarfare.html">cyberwarfare</a></li>
	              <li ><a href="../../../../category/digital-divide.html">digital divide</a></li>
	              <li ><a href="../../../../category/hate-speech.html">hate speech</a></li>
	              <li ><a href="../../../../category/hate-speechnetwork-security.html">hate speechnetwork security</a></li>
	              <li ><a href="../../../../category/honeypot.html">honeypot</a></li>
	              <li ><a href="../../../../category/human-communication.html">human communication</a></li>
	              <li ><a href="../../../../category/human-computer-interaction.html">human computer interaction</a></li>
	              <li ><a href="../../../../category/human-rights.html">human rights</a></li>
	              <li ><a href="../../../../category/ids.html">IDS</a></li>
	              <li ><a href="../../../../category/interview.html">interview</a></li>
	              <li ><a href="../../../../category/leaks.html">leaks</a></li>
	              <li class="active"><a href="../../../../category/malware.html">malware</a></li>
	              <li ><a href="../../../../category/network-security.html">network security</a></li>
	              <li ><a href="../../../../category/password-attacks.html">password attacks</a></li>
	              <li ><a href="../../../../category/regular-expression.html">regular expression</a></li>
	              <li ><a href="../../../../category/research.html">research</a></li>
	              <li ><a href="../../../../category/risk-assessment.html">risk assessment</a></li>
	              <li ><a href="../../../../category/script-kiddie.html">script kiddie</a></li>
	              <li ><a href="../../../../category/security-programing.html">security programing</a></li>
	              <li ><a href="../../../../category/security-testing.html">security testing</a></li>
	              <li ><a href="../../../../category/social-networks.html">social networks</a></li>
	              <li ><a href="../../../../category/texworks.html">texworks</a></li>
	              <li ><a href="../../../../category/thinkpad.html">thinkpad</a></li>
	              <li ><a href="../../../../category/virtual-life.html">virtual life</a></li>
	              <li ><a href="../../../../category/wireless-security.html">wireless security</a></li>
	              <li ><a href="../../../../category/wordpress.html">wordpress</a></li>
	          </ul>
	        </nav>

	          <aside>
	          <h2>Social</h2>
			    <ul class="social">
				  <li><a href="https://www.linkedin.com/in/tpredrag">Linkedin</a><i></i></li>
				  <li><a href="https://twitter.com/stepcellwolf">Twitter</a><i></i></li>
				  <li><a href="https://github.com/stepcellwolf/">Github</a><i></i></li>
			    </ul>
			  </aside>

	          <aside>
	            <h2>Blogroll</h2>
	            <ul>
	                <li><a href="http://getpelican.com/">Pelican</a></li>
	                <li><a href="http://python.org/">Python.org</a></li>
	                <li><a href="http://jinja.pocoo.org/">Jinja2</a></li>
	                <li><a href="#">You can modify those links in your config file</a></li>
	            </ul>
	          </aside>

		  </div>

	  </div>

      <footer>
		<p role="contentinfo">
		  © 2013 Predrag TASEVSKI - Pece - Proudly powered by <a href="http://alexis.notmyidea.org/pelican/">pelican</a>. Theme <a href="https://github.com/fle/pelican-simplegrey">pelican-simplegrey</a>.
    	</p>

	  </footer>	

	</div>
	

</body>
</html>